"use strict";(function(){if(jQuery&&jQuery.jstree){return}var A=false,is_ie7=false,is_ff2=false;(function($){$.vakata={};$.vakata.css={get_css:function(a,b,c){a=a.toLowerCase();var d=c.cssRules||c.rules,j=0;do{if(d.length&&j>d.length+5){return false}if(d[j].selectorText&&d[j].selectorText.toLowerCase()==a){if(b===true){if(c.removeRule){c.removeRule(j)}if(c.deleteRule){c.deleteRule(j)}return true}else{return d[j]}}}while(d[++j]);return false},add_css:function(a,b){if($.jstree.css.get_css(a,false,b)){return false}if(b.insertRule){b.insertRule(a+' { }',0)}else{b.addRule(a,null,0)}return $.vakata.css.get_css(a)},remove_css:function(a,b){return $.vakata.css.get_css(a,true,b)},add_sheet:function(a){var b=false,is_new=true;if(a.str){if(a.title){b=$("style[id='"+a.title+"-stylesheet']")[0]}if(b){is_new=false}else{b=document.createElement("style");b.setAttribute('type',"text/css");if(a.title){b.setAttribute("id",a.title+"-stylesheet")}}if(b.styleSheet){if(is_new){document.getElementsByTagName("head")[0].appendChild(b);b.styleSheet.cssText=a.str}else{b.styleSheet.cssText=b.styleSheet.cssText+" "+a.str}}else{b.appendChild(document.createTextNode(a.str));document.getElementsByTagName("head")[0].appendChild(b)}return b.sheet||b.styleSheet}if(a.url){if(document.createStyleSheet){try{b=document.createStyleSheet(a.url)}catch(e){}}else{b=document.createElement('link');b.rel='stylesheet';b.type='text/css';b.media="all";b.href=a.url;document.getElementsByTagName("head")[0].appendChild(b);return b.styleSheet}}}};var h=[],focused_instance=-1,plugins={},prepared_move={};$.fn.jstree=function(e){var f=(typeof e=='string'),args=Array.prototype.slice.call(arguments,1),returnValue=this;if(f){if(e.substring(0,1)=='_'){return returnValue}this.each(function(){var a=h[$.data(this,"jstree_instance_id")],methodValue=(a&&$.isFunction(a[e]))?a[e].apply(a,args):a;if(typeof methodValue!=="undefined"&&(e.indexOf("is_")===0||(methodValue!==true&&methodValue!==false))){returnValue=methodValue;return false}})}else{this.each(function(){var d=$.data(this,"jstree_instance_id"),a=[],b=e?$.extend({},true,e):{},c=$(this),s=false,t=[];a=a.concat(args);if(c.data("jstree")){a.push(c.data("jstree"))}b=a.length?$.extend.apply(null,[true,b].concat(a)):b;if(typeof d!=="undefined"&&h[d]){h[d].destroy()}d=parseInt(h.push({}),10)-1;$.data(this,"jstree_instance_id",d);b.plugins=$.isArray(b.plugins)?b.plugins:$.jstree.defaults.plugins.slice();b.plugins.unshift("core");b.plugins=b.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");s=$.extend(true,{},$.jstree.defaults,b);s.plugins=b.plugins;$.each(plugins,function(i,a){if($.inArray(i,s.plugins)===-1){s[i]=null;delete s[i]}else{t.push(i)}});s.plugins=t;h[d]=new $.jstree._instance(d,$(this).addClass("jstree jstree-"+d),s);$.each(h[d]._get_settings().plugins,function(i,a){h[d].data[a]={}});$.each(h[d]._get_settings().plugins,function(i,a){if(plugins[a]){plugins[a].__init.apply(h[d])}});setTimeout(function(){if(h[d]){h[d].init()}},0)})}return returnValue};$.jstree={defaults:{plugins:[]},_focused:function(){return h[focused_instance]||null},_reference:function(a){if(h[a]){return h[a]}var o=$(a);if(!o.length&&typeof a==="string"){o=$("#"+a)}if(!o.length){return null}return h[o.closest(".jstree").data("jstree_instance_id")]||null},_instance:function(a,b,c){this.data={core:{}};this.get_settings=function(){return $.extend(true,{},c)};this._get_settings=function(){return c};this.get_index=function(){return a};this.get_container=function(){return b};this.get_container_ul=function(){return b.children("ul:eq(0)")};this._set_settings=function(s){c=$.extend(true,{},c,s)}},_fn:{},plugin:function(d,e){e=$.extend({},{__init:$.noop,__destroy:$.noop,_fn:{},defaults:false},e);plugins[d]=e;$.jstree.defaults[d]=e.defaults;$.each(e._fn,function(i,c){c.plugin=d;c.old=$.jstree._fn[i];$.jstree._fn[i]=function(){var b,func=c,args=Array.prototype.slice.call(arguments),evnt=new $.Event("before.jstree"),rlbk=false;if(this.data.core.locked===true&&i!=="unlock"&&i!=="is_locked"){return}do{if(func&&func.plugin&&$.inArray(func.plugin,this._get_settings().plugins)!==-1){break}func=func.old}while(func);if(!func){return}if(i.indexOf("_")===0){b=func.apply(this,args)}else{b=this.get_container().triggerHandler(evnt,{"func":i,"inst":this,"args":args,"plugin":func.plugin});if(b===false){return}if(typeof b!=="undefined"){args=b}b=func.apply($.extend({},this,{__callback:function(a){this.get_container().triggerHandler(i+'.jstree',{"inst":this,"args":args,"rslt":a,"rlbk":rlbk})},__rollback:function(){rlbk=this.get_rollback();return rlbk},__call_old:function(a){return func.old.apply(this,(a?Array.prototype.slice.call(arguments,1):args))}}),args)}return b};$.jstree._fn[i].old=c.old;$.jstree._fn[i].plugin=d})},rollback:function(b){if(b){if(!$.isArray(b)){b=[b]}$.each(b,function(i,a){h[a.i].set_rollback(a.h,a.d)})}}};$.jstree._fn=$.jstree._instance.prototype={};$(function(){var u=navigator.userAgent.toLowerCase(),v=(u.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,'0'])[1],css_string=''+'.jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } '+'.jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } '+'.jstree-rtl li { margin-left:0; margin-right:18px; } '+'.jstree > ul > li { margin-left:0px; } '+'.jstree-rtl > ul > li { margin-right:0px; } '+'.jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } '+'.jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } '+'.jstree a:focus { outline: none; } '+'.jstree a > ins { height:16px; width:16px; } '+'.jstree a > .jstree-icon { margin-right:3px; } '+'.jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } '+'li.jstree-open > ul { display:block; } '+'li.jstree-closed > ul { display:none; } '+'.jstree.type1 a{width:140px; overflow:hidden; text-overflow: ellipsis;} ';if(/msie/.test(u)&&parseInt(v,10)==6){A=true;try{document.execCommand("BackgroundImageCache",false,true)}catch(err){}css_string+=''+'.jstree li { height:18px; margin-left:0; margin-right:0; } '+'.jstree li li { margin-left:18px; } '+'.jstree-rtl li li { margin-left:0px; margin-right:18px; } '+'li.jstree-open ul { display:block; } '+'li.jstree-closed ul { display:none !important; } '+'.jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } '+'.jstree li a ins { height:16px; width:16px; margin-right:3px; } '+'.jstree-rtl li a ins { margin-right:0px; margin-left:3px; } '}if(/msie/.test(u)&&parseInt(v,10)==7){is_ie7=true;css_string+='.jstree li a { border-width:0 !important; padding:0px 2px !important; } '}if(!/compatible/.test(u)&&/mozilla/.test(u)&&parseFloat(v,10)<1.9){is_ff2=true;css_string+=''+'.jstree ins { display:-moz-inline-box; } '+'.jstree li { line-height:12px; } '+'.jstree a { display:-moz-inline-box; } '+'.jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } '}$.vakata.css.add_sheet({str:css_string,title:"jstree"})});$.jstree.plugin("core",{__init:function(){this.data.core.locked=false;this.data.core.to_open=this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:false,animation:500,initially_open:[],initially_load:[],open_parents:true,notify_plugins:true,rtl:false,load_open:false,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();if(this._get_settings().core.rtl){this.get_container().addClass("jstree-rtl").css("direction","rtl")}this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",$.proxy(function(a){var b=$(a.target);this.toggle_node(b)},this)).bind("mousedown.jstree",$.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(a){var b;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){b=window.getSelection();try{b.removeAllRanges();b.collapse()}catch(err){}}}});if(this._get_settings().core.notify_plugins){this.get_container().bind("load_node.jstree",$.proxy(function(e,d){var o=this._get_node(d.rslt.obj),t=this;if(o===-1){o=this.get_container_ul()}if(!o.length){return}o.find("li").each(function(){var c=$(this);if(c.data("jstree")){$.each(c.data("jstree"),function(a,b){if(t.data[a]&&$.isFunction(t["_"+a+"_notify"])){t["_"+a+"_notify"].call(t,c,b)}})}})},this))}if(this._get_settings().core.load_open){this.get_container().bind("load_node.jstree",$.proxy(function(e,a){var o=this._get_node(a.rslt.obj),t=this;if(o===-1){o=this.get_container_ul()}if(!o.length){return}o.find("li.jstree-open:not(:has(ul))").each(function(){t.load_node(this,$.noop,$.noop)})},this))}this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var i,n=this.get_index(),s=this._get_settings(),_this=this;$.each(s.plugins,function(i,a){try{plugins[a].__destroy.apply(_this)}catch(err){}});this.__callback();if(this.is_focused()){for(i in h){if(h.hasOwnProperty(i)&&i!=n){h[i].set_focus();break}}}if(n===focused_instance){focused_instance=-1}this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,'')});$(document).unbind(".jstree-"+n).undelegate(".jstree-"+n);h[n]=null;delete h[n]},_core_notify:function(n,a){if(a.opened){this.open_node(n,false,true)}},lock:function(){this.data.core.locked=true;this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7");this.__callback({})},unlock:function(){this.data.core.locked=false;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){if(this.id){a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(b){var c=this,done=true,current=[],remaining=[];if(!b){this.data.core.reopen=false;this.data.core.refreshing=true;this.data.core.to_open=$.map($.makeArray(this.data.core.to_open),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.data.core.to_load=$.map($.makeArray(this.data.core.to_load),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});if(this.data.core.to_open.length){this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)}}if(this.data.core.to_load.length){$.each(this.data.core.to_load,function(i,a){if(a=="#"){return true}if($(a).length){current.push(a)}else{remaining.push(a)}});if(current.length){this.data.core.to_load=remaining;$.each(current,function(i,a){if(!c._is_loaded(a)){c.load_node(a,function(){c.reload_nodes(true)},function(){c.reload_nodes(true)});done=false}})}}if(this.data.core.to_open.length){$.each(this.data.core.to_open,function(i,a){c.open_node(a,false,true)})}if(done){if(this.data.core.reopen){clearTimeout(this.data.core.reopen)}this.data.core.reopen=setTimeout(function(){c.__callback({},c)},50);this.data.core.refreshing=false;this.reopen()}},reopen:function(){var b=this;if(this.data.core.to_open.length){$.each(this.data.core.to_open,function(i,a){b.open_node(a,false,true)})}this.__callback({})},refresh:function(a){var b=this;this.save_opened();if(!a){a=-1}a=this._get_node(a);if(!a){a=-1}if(a!==-1){a.children("UL").remove()}else{this.get_container_ul().empty()}this.load_node(a,function(){b.__callback({"obj":a});b.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused()){return}var f=$.jstree._focused();if(f){f.unset_focus()}this.get_container().addClass("jstree-focused");focused_instance=this.get_index();this.__callback()},is_focused:function(){return focused_instance==this.get_index()},unset_focus:function(){if(this.is_focused()){this.get_container().removeClass("jstree-focused");focused_instance=-1}this.__callback()},_get_node:function(a){var b=$(a,this.get_container());if(b.is(".jstree")||a==-1){return-1}b=b.closest("li",this.get_container());return b.length?b:false},_get_next:function(a,b){a=this._get_node(a);if(a===-1){return this.get_container().find("> ul > li:first-child")}if(!a.length){return false}if(b){return(a.nextAll("li").size()>0)?a.nextAll("li:eq(0)"):false}if(a.hasClass("jstree-open")){return a.find("li:eq(0)")}else if(a.nextAll("li").size()>0){return a.nextAll("li:eq(0)")}else{return a.parentsUntil(".jstree","li").next("li").eq(0)}},_get_prev:function(a,b){a=this._get_node(a);if(a===-1){return this.get_container().find("> ul > li:last-child")}if(!a.length){return false}if(b){return(a.prevAll("li").length>0)?a.prevAll("li:eq(0)"):false}if(a.prev("li").length){a=a.prev("li").eq(0);while(a.hasClass("jstree-open")){a=a.children("ul:eq(0)").children("li:last")}return a}else{var o=a.parentsUntil(".jstree","li:eq(0)");return o.length?o:false}},_get_parent:function(a){a=this._get_node(a);if(a==-1||!a.length){return false}var o=a.parentsUntil(".jstree","li:eq(0)");return o.length?o:-1},_get_children:function(a){a=this._get_node(a);if(a===-1){return this.get_container().children("ul:eq(0)").children("li")}if(!a.length){return false}return a.children("ul:eq(0)").children("li")},get_path:function(a,b){var p=[],_this=this;a=this._get_node(a);if(a===-1||!a||!a.length){return false}a.parentsUntil(".jstree","li").each(function(){p.push(b?this.id:_this.get_text(this))});p.reverse();p.push(b?a.attr("id"):this.get_text(a));return p},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-open")},is_closed:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-closed")},is_leaf:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||a===-1){return false}a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({"obj":a})},open_node:function(a,b,c){a=this._get_node(a);if(!a.length){return false}if(!a.hasClass("jstree-closed")){if(b){b.call()}return false}var s=c||A?0:this._get_settings().core.animation,t=this;if(!this._is_loaded(a)){a.children("a").addClass("jstree-loading");this.load_node(a,function(){t.open_node(a,b,c)},b)}else{if(this._get_settings().core.open_parents){a.parentsUntil(".jstree",".jstree-closed").each(function(){t.open_node(this,false,true)})}if(s){a.children("ul").css("display","none")}a.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");if(s){a.children("ul").stop(true,true).slideDown(s,function(){this.style.display="";t.after_open(a)})}else{t.after_open(a)}this.__callback({"obj":a});if(b){b.call()}}},after_open:function(a){this.__callback({"obj":a})},close_node:function(a,b){a=this._get_node(a);var s=b||A?0:this._get_settings().core.animation,t=this;if(!a.length||!a.hasClass("jstree-open")){return false}if(s){a.children("ul").attr("style","display:block !important")}a.removeClass("jstree-open").addClass("jstree-closed");if(s){a.children("ul").stop(true,true).slideUp(s,function(){this.style.display="";t.after_close(a)})}else{t.after_close(a)}this.__callback({"obj":a})},after_close:function(a){this.__callback({"obj":a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed")){return this.open_node(a)}if(a.hasClass("jstree-open")){return this.close_node(a)}},open_all:function(b,c,d){b=b?this._get_node(b):-1;if(!b||b===-1){b=this.get_container_ul()}if(d){b=b.find("li.jstree-closed")}else{d=b;if(b.is(".jstree-closed")){b=b.find("li.jstree-closed").addBack()}else{b=b.find("li.jstree-closed")}}var e=this;b.each(function(){var a=this;if(!e._is_loaded(this)){e.open_node(this,function(){e.open_all(a,c,d)},!c)}else{e.open_node(this,false,!c)}});if(d.find('li.jstree-closed').length===0){this.__callback({"obj":d})}},close_all:function(a,b){var c=this;a=a?this._get_node(a):this.get_container();if(!a||a===-1){a=this.get_container_ul()}a.find("li.jstree-open").addBack().each(function(){c.close_node(this,!b)});this.__callback({"obj":a})},clean_node:function(a){a=a&&a!=-1?$(a):this.get_container_ul();a=a.is("li")?a.find("li").addBack():a.find("li");a.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");a.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({"obj":a})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data}},set_rollback:function(a,b){this.get_container().empty().append(a);this.data=b;this.__callback()},load_node:function(a,b,c){this.__callback({"obj":a})},_is_loaded:function(a){return true},create_node:function(a,b,c,e,f){a=this._get_node(a);b=typeof b==="undefined"?"last":b;var d=$("<li />"),s=this._get_settings().core,tmp;if(a!==-1&&!a.length){return false}if(!f&&!this._is_loaded(a)){this.load_node(a,function(){this.create_node(a,b,c,e,true)});return false}this.__rollback();if(typeof c==="string"){c={"data":c}}if(!c){c={}}if(c.attr){d.attr(c.attr)}if(c.metadata){d.data(c.metadata)}if(c.state){d.addClass("jstree-"+c.state)}if(!c.data){c.data=this._get_string("new_node")}if(!$.isArray(c.data)){tmp=c.data;c.data=[];c.data.push(tmp)}$.each(c.data,function(i,m){tmp=$("<a />");if($.isFunction(m)){m=m.call(this,c)}if(typeof m=="string"){tmp.attr('href','#')[s.html_titles?"html":"text"](m)}else{if(!m.attr){m.attr={}}if(!m.attr.href){m.attr.href='#'}tmp.attr(m.attr)[s.html_titles?"html":"text"](m.title);if(m.language){tmp.addClass(m.language)}}tmp.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!m.icon&&c.icon){m.icon=c.icon}if(m.icon){if(m.icon.indexOf("/")===-1){tmp.children("ins").addClass(m.icon)}else{tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat")}}d.append(tmp)});d.prepend("<ins class='jstree-icon'>&#160;</ins>");if(a===-1){a=this.get_container();if(b==="before"){b="first"}if(b==="after"){b="last"}}switch(b){case"before":a.before(d);tmp=this._get_parent(a);break;case"after":a.after(d);tmp=this._get_parent(a);break;case"inside":case"first":if(!a.children("ul").length){a.append("<ul />")}a.children("ul").prepend(d);tmp=a;break;case"last":if(!a.children("ul").length){a.append("<ul />")}a.children("ul").append(d);tmp=a;break;default:if(!a.children("ul").length){a.append("<ul />")}if(!b){b=0}tmp=a.children("ul").children("li").eq(b);if(tmp.length){tmp.before(d)}else{a.children("ul").append(d)}tmp=a;break}if(tmp===-1||tmp.get(0)===this.get_container().get(0)){tmp=-1}this.clean_node(tmp);this.__callback({"obj":d,"parent":tmp});if(e){e.call(this,d)}return d},get_text:function(a){a=this._get_node(a);if(!a.length){return false}var s=this._get_settings().core.html_titles;a=a.children("a:eq(0)");if(s){a=a.clone();a.children("INS").remove();return a.html()}else{a=a.contents().filter(function(){return this.nodeType==3})[0];return a.nodeValue}},set_text:function(a,b){a=this._get_node(a);if(!a.length){return false}a=a.children("a:eq(0)");if(this._get_settings().core.html_titles){var c=a.children("INS").clone();a.html(b).prepend(c);this.__callback({"obj":a,"name":b});return true}else{a=a.contents().filter(function(){return this.nodeType==3})[0];this.__callback({"obj":a,"name":b});return(a.nodeValue=b)}},rename_node:function(a,b){a=this._get_node(a);this.__rollback();if(a&&a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))){this.__callback({"obj":a,"name":b})}},delete_node:function(a){a=this._get_node(a);if(!a.length){return false}this.__rollback();var p=this._get_parent(a),prev=$([]),t=this;a.each(function(){prev=prev.add(t._get_prev(this))});a=a.detach();if(p!==-1&&p.find("> ul > li").length===0){p.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}this.clean_node(p);this.__callback({"obj":a,"prev":prev,"parent":p});return a},prepare_move:function(o,r,a,b,c){var p={};p.ot=$.jstree._reference(o)||this;p.o=p.ot._get_node(o);p.r=r===-1?-1:this._get_node(r);p.p=(typeof a==="undefined"||a===false)?"last":a;if(!c&&prepared_move.o&&prepared_move.o[0]===p.o[0]&&prepared_move.r[0]===p.r[0]&&prepared_move.p===p.p){this.__callback(prepared_move);if(b){b.call(this,prepared_move)}return}p.ot=$.jstree._reference(p.o)||this;p.rt=$.jstree._reference(p.r)||this;if(p.r===-1||!p.r){p.cr=-1;switch(p.p){case"first":case"before":case"inside":p.cp=0;break;case"after":case"last":p.cp=p.rt.get_container().find(" > ul > li").length;break;default:p.cp=p.p;break}}else{if(!/^(before|after)$/.test(p.p)&&!this._is_loaded(p.r)){return this.load_node(p.r,function(){this.prepare_move(o,r,a,b,true)})}switch(p.p){case"before":p.cp=p.r.index();p.cr=p.rt._get_parent(p.r);break;case"after":p.cp=p.r.index()+1;p.cr=p.rt._get_parent(p.r);break;case"inside":case"first":p.cp=0;p.cr=p.r;break;case"last":p.cp=p.r.find(" > ul > li").length;p.cr=p.r;break;default:p.cp=p.p;p.cr=p.r;break}}p.np=p.cr==-1?p.rt.get_container():p.cr;p.op=p.ot._get_parent(p.o);p.cop=p.o.index();if(p.op===-1){p.op=p.ot?p.ot.get_container():this.get_container()}if(!/^(before|after)$/.test(p.p)&&p.op&&p.np&&p.op[0]===p.np[0]&&p.o.index()<p.cp){p.cp++}p.or=p.np.find(" > ul > li:nth-child("+(p.cp+1)+")");prepared_move=p;this.__callback(prepared_move);if(b){b.call(this,prepared_move)}},check_move:function(){var a=prepared_move,ret=true,r=a.r===-1?this.get_container():a.r;if(!a||!a.o||a.or[0]===a.o[0]){return false}if(!a.cy){if(a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index()){return false}a.o.each(function(){if(r.parentsUntil(".jstree","li").addBack().index(this)!==-1){ret=false;return false}})}return ret},move_node:function(a,b,c,d,f,g){if(!f){return this.prepare_move(a,b,c,function(p){this.move_node(p,false,false,d,true,g)})}if(d){prepared_move.cy=true}if(!g&&!this.check_move()){return false}this.__rollback();var o=false;if(d){o=a.o.clone(true);o.find("*[id]").addBack().each(function(){if(this.id){this.id="copy_"+this.id}})}else{o=a.o}if(a.or.length){a.or.before(o)}else{if(!a.np.children("ul").length){$("<ul />").appendTo(a.np)}a.np.children("ul:eq(0)").append(o)}try{a.ot.clean_node(a.op);a.rt.clean_node(a.np);if(!a.op.find("> ul > li").length){a.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}}catch(e){}if(d){prepared_move.cy=true;prepared_move.oc=o}this.__callback(prepared_move);return prepared_move},_get_move:function(){return prepared_move}}})})(jQuery);(function($){var d,e1,e2;$(function(){if(/msie/.test(navigator.userAgent.toLowerCase())){e1=$('<textarea cols="10" rows="2"></textarea>').css({position:'absolute',top:-1000,left:0}).appendTo('body');e2=$('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:'absolute',top:-1000,left:0}).appendTo('body');d=e1.width()-e2.width();e1.add(e2).remove()}else{e1=$('<div />').css({width:100,height:100,overflow:'auto',position:'absolute',top:-1000,left:0}).prependTo('body').append('<div />').find('div').css({width:'100%',height:200});d=100-e1.width();e1.parent().remove()}});$.jstree.plugin("ui",{__init:function(){this.data.ui.selected=$();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",$.proxy(function(a){a.preventDefault();a.currentTarget.blur();if(!$(a.currentTarget).hasClass("jstree-loading")){this.select_node(a.currentTarget,true,a)}},this)).delegate("a","mouseenter.jstree",$.proxy(function(a){if(!$(a.currentTarget).hasClass("jstree-loading")){this.hover_node(a.target)}},this)).delegate("a","mouseleave.jstree",$.proxy(function(a){if(!$(a.currentTarget).hasClass("jstree-loading")){this.dehover_node(a.target)}},this)).bind("reopen.jstree",$.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",$.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",$.proxy(function(){this.reselect()},this)).bind("close_node.jstree",$.proxy(function(a,b){var s=this._get_settings().ui,obj=this._get_node(b.rslt.obj),clk=(obj&&obj.length)?obj.children("ul").find("a.jstree-clicked"):$(),_this=this;if(s.selected_parent_close===false||!clk.length){return}clk.each(function(){_this.deselect_node(this);if(s.selected_parent_close==="select_parent"){_this.select_node(obj)}})},this)).bind("delete_node.jstree",$.proxy(function(a,b){var s=this._get_settings().ui.select_prev_on_delete,obj=this._get_node(b.rslt.obj),clk=(obj&&obj.length)?obj.find("a.jstree-clicked"):[],_this=this;clk.each(function(){_this.deselect_node(this)});if(s&&clk.length){b.rslt.prev.each(function(){if(this.parentNode){_this.select_node(this);return false}})}},this)).bind("move_node.jstree",$.proxy(function(a,b){if(b.rslt.cy){b.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")}},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:true,select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(a,b){if(typeof a==="undefined"||a===null){return b?this.data.ui.selected:this.data.ui.last_selected}var c=$(a,this.get_container());if(c.is(".jstree")||a==-1){return-1}c=c.closest("li",this.get_container());return c.length?c:false},_ui_notify:function(n,a){if(a.selected){this.select_node(n,false)}},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){if(this.id){a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(this.data.ui.to_select)},reselect:function(){var b=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});$.each(s,function(i,a){if(a&&a!=="#"){b.select_node(a)}});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(a){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length){return false}if(!a.hasClass("jstree-hovered")){this.dehover_node()}this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this._fix_scroll(a);this.__callback({"obj":a})},dehover_node:function(){var a=this.data.ui.hovered,p;if(!a||!a.length){return false}p=a.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===p[0]){this.data.ui.hovered=null}this.__callback({"obj":a})},select_node:function(a,b,e){a=this._get_node(a);if(a==-1||!a||!a.length){return false}var s=this._get_settings().ui,is_multiple=(s.select_multiple_modifier=="on"||(s.select_multiple_modifier!==false&&e&&e[s.select_multiple_modifier+"Key"])),is_range=(s.select_range_modifier!==false&&e&&e[s.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0]),is_selected=this.is_selected(a),proceed=true,t=this;if(b){if(s.disable_selecting_children&&is_multiple&&((a.parentsUntil(".jstree","li").children("a.jstree-clicked").length)||(a.children("ul").find("a.jstree-clicked:eq(0)").length))){return false}proceed=false;switch(!0){case(is_range):this.data.ui.last_selected.addClass("jstree-last-selected");a=a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").addBack();if(s.select_limit==-1||a.length<s.select_limit){this.data.ui.last_selected.removeClass("jstree-last-selected");this.data.ui.selected.each(function(){if(this!==t.data.ui.last_selected[0]){t.deselect_node(this)}});is_selected=false;proceed=true}else{proceed=false}break;case(is_selected&&!is_multiple):this.deselect_all();is_selected=false;proceed=true;break;case(!is_selected&&!is_multiple):if(s.select_limit==-1||s.select_limit>0){this.deselect_all();proceed=true}break;case(is_selected&&is_multiple):this.deselect_node(a);break;case(!is_selected&&is_multiple):if(s.select_limit==-1||this.data.ui.selected.length+1<=s.select_limit){proceed=true}break}}if(proceed&&!is_selected){if(!is_range){this.data.ui.last_selected=a}a.children("a").addClass("jstree-clicked");if(s.selected_parent_open){a.parents(".jstree-closed").each(function(){t.open_node(this,false,true)})}this.data.ui.selected=this.data.ui.selected.add(a);this._fix_scroll(a.eq(0));this.__callback({"obj":a,"e":e})}},_fix_scroll:function(a){var c=this.get_container()[0],t;if(c.scrollHeight>c.offsetHeight){a=this._get_node(a);if(!a||a===-1||!a.length||!a.is(":visible")){return}t=a.offset().top-this.get_container().offset().top;if(t<0){c.scrollTop=c.scrollTop+t-1}if(t+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?d:0)>c.offsetHeight){c.scrollTop=c.scrollTop+(t-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?d:0))}}},deselect_node:function(a){a=this._get_node(a);if(!a.length){return false}if(this.is_selected(a)){a.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(a);if(this.data.ui.last_selected.get(0)===a.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0)}this.__callback({"obj":a})}},toggle_select:function(a){a=this._get_node(a);if(!a.length){return false}if(this.is_selected(a)){this.deselect_node(a)}else{this.select_node(a)}},is_selected:function(a){return this.data.ui.selected.index(this._get_node(a))>=0},get_selected:function(a){return a?$(a).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(a){var b=a?$(a).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();b.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=$([]);this.data.ui.last_selected=false;this.__callback({"obj":b})}}});$.jstree.defaults.plugins.push("ui")})(jQuery);(function($){$.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",$.proxy(function(e,a){if(this._get_settings().crrm.move.open_onmove){var t=this;a.rslt.np.parentsUntil(".jstree").addBack().filter(".jstree-closed").each(function(){t.open_node(this,false,true)})}},this))},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(m){return true}}},_fn:{_show_input:function(c,d){c=this._get_node(c);var e=this._get_settings().core.rtl,w=this._get_settings().crrm.input_width_limit,w1=c.children("ins").width(),w2=c.find("> a:visible > ins").width()*c.find("> a:visible > ins").length,t=this.get_text(c),h1=$("<div />",{css:{"position":"absolute","top":"-200px","left":(e?"0px":"-1000px"),"visibility":"hidden"}}).appendTo("body"),h2=c.css("position","relative").append($("<input />",{"value":t,"class":"jstree-rename-input","css":{"padding":"0","border":"1px solid silver","position":"absolute","left":(e?"auto":(w1+w2+4)+"px"),"right":(e?(w1+w2+4)+"px":"auto"),"top":"0px","height":(this.data.core.li_height-2)+"px","lineHeight":(this.data.core.li_height-2)+"px","width":"150px"},"blur":$.proxy(function(){var i=c.children(".jstree-rename-input"),v=i.val();if(v===""){v=t}h1.remove();i.remove();this.set_text(c,t);this.rename_node(c,v);d.call(this,c,v,t);c.css("position","")},this),"keyup":function(a){var b=a.keyCode||a.which;if(b==27){this.value=t;this.blur();return}else if(b==13){this.blur();return}else{h2.width(Math.min(h1.text("pW"+this.value).width(),w))}},"keypress":function(a){var b=a.keyCode||a.which;if(b==13){return false}}})).children(".jstree-rename-input");this.set_text(c,"");h1.css({fontFamily:h2.css('fontFamily')||'',fontSize:h2.css('fontSize')||'',fontWeight:h2.css('fontWeight')||'',fontStyle:h2.css('fontStyle')||'',fontStretch:h2.css('fontStretch')||'',fontVariant:h2.css('fontVariant')||'',letterSpacing:h2.css('letterSpacing')||'',wordSpacing:h2.css('wordSpacing')||''});h2.width(Math.min(h1.text("pW"+h2[0].value).width(),w))[0].select()},rename:function(d){d=this._get_node(d);this.__rollback();var f=this.__callback;this._show_input(d,function(a,b,c){f.call(this,{"obj":a,"new_name":b,"old_name":c})})},create:function(d,e,f,g,h){var t,_this=this;d=this._get_node(d);if(!d){d=-1}this.__rollback();t=this.create_node(d,e,f,function(t){var p=this._get_parent(t),pos=$(t).index();if(g){g.call(this,t)}if(p.length&&p.hasClass("jstree-closed")){this.open_node(p,false,true)}if(!h){this._show_input(t,function(a,b,c){_this.__callback({"obj":a,"name":b,"parent":p,"position":pos})})}else{_this.__callback({"obj":t,"name":this.get_text(t),"parent":p,"position":pos})}});return t},remove:function(a){a=this._get_node(a,true);var p=this._get_parent(a),prev=this._get_prev(a);this.__rollback();a=this.delete_node(a);if(a!==false){this.__callback({"obj":a,"prev":prev,"parent":p})}},check_move:function(){if(!this.__call_old()){return false}var s=this._get_settings().crrm.move;if(!s.check_move.call(this,this._get_move())){return false}return true},move_node:function(a,b,c,d,e,f){var s=this._get_settings().crrm.move;if(!e){if(typeof c==="undefined"){c=s.default_position}if(c==="inside"&&!s.default_position.match(/^(before|after)$/)){c=s.default_position}return this.__call_old(true,a,b,c,d,false,f)}if(s.always_copy===true||(s.always_copy==="multitree"&&a.rt.get_index()!==a.ot.get_index())){d=true}this.__call_old(true,a,b,c,d,true,f)},cut:function(a){a=this._get_node(a,true);if(!a||!a.length){return false}this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=a;this.__callback({"obj":a})},copy:function(a){a=this._get_node(a,true);if(!a||!a.length){return false}this.data.crrm.ct_nodes=false;this.data.crrm.cp_nodes=a;this.__callback({"obj":a})},paste:function(a){a=this._get_node(a);if(!a||!a.length){return false}var b=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes){return false}if(this.data.crrm.ct_nodes){this.move_node(this.data.crrm.ct_nodes,a);this.data.crrm.ct_nodes=false}if(this.data.crrm.cp_nodes){this.move_node(this.data.crrm.cp_nodes,a,false,true)}this.__callback({"obj":a,"nodes":b})}}})})(jQuery);(function($){var c=[];$.jstree._themes=false;$.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",$.proxy(function(){var s=this._get_settings().themes;this.data.themes.dots=s.dots;this.data.themes.icons=s.icons;this.set_theme(s.theme,s.url)},this)).bind("loaded.jstree",$.proxy(function(){if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}},this))},defaults:{theme:"default",url:false,dots:true,icons:true},_fn:{set_theme:function(a,b){if(!a){return false}if(!b){b=$.jstree._themes+a+'/style.css'}if($.inArray(b,c)==-1){$.vakata.css.add_sheet({"url":b});c.push(b)}if(this.data.themes.theme!=a){this.get_container().removeClass('jstree-'+this.data.themes.theme);this.data.themes.theme=a}this.get_container().addClass('jstree-'+a);if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons()}else{this.show_icons()}}}});$(function(){if($.jstree._themes===false){$("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){$.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+'themes/';return false}})}if($.jstree._themes===false){$.jstree._themes="themes/"}});$.jstree.defaults.plugins.push("themes")})(jQuery);(function($){var b=[];function exec(i,a){var f=$.jstree._focused(),tmp;if(f&&f.data&&f.data.hotkeys&&f.data.hotkeys.enabled){tmp=f._get_settings().hotkeys[i];if(tmp){return tmp.call(f,a)}}}$.jstree.plugin("hotkeys",{__init:function(){if(typeof $.hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included.";}if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included.";}$.each(this._get_settings().hotkeys,function(i,v){if(v!==false&&$.inArray(i,b)==-1){$(document).bind("keydown",i,function(a){return exec(i,a)});b.push(i)}});this.get_container().bind("lock.jstree",$.proxy(function(){if(this.data.hotkeys.enabled){this.data.hotkeys.enabled=false;this.data.hotkeys.revert=true}},this)).bind("unlock.jstree",$.proxy(function(){if(this.data.hotkeys.revert){this.data.hotkeys.enabled=true}},this));this.enable_hotkeys()},defaults:{"up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false},"ctrl+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false},"shift+up":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(o));return false},"down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false},"ctrl+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false},"shift+down":function(){var o=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(o));return false},"left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o)}else{this.hover_node(this._get_prev(o))}}return false},"ctrl+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o)}else{this.hover_node(this._get_prev(o))}}return false},"shift+left":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o){if(o.hasClass("jstree-open")){this.close_node(o)}else{this.hover_node(this._get_prev(o))}}return false},"right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o)}else{this.hover_node(this._get_next(o))}}return false},"ctrl+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o)}else{this.hover_node(this._get_next(o))}}return false},"shift+right":function(){var o=this.data.ui.hovered||this.data.ui.last_selected;if(o&&o.length){if(o.hasClass("jstree-closed")){this.open_node(o)}else{this.hover_node(this._get_next(o))}}return false},"space":function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click()}return false},"ctrl+space":function(a){a.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(a)}return false},"shift+space":function(a){a.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(a)}return false},"f2":function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},"del":function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true},disable_hotkeys:function(){this.data.hotkeys.enabled=false}}})})(jQuery);(function($){$.jstree.plugin("json_data",{__init:function(){var s=this._get_settings().json_data;if(s.progressive_unload){this.get_container().bind("after_close.jstree",function(e,a){a.rslt.obj.children("ul").remove()})}},defaults:{data:false,ajax:false,correct_state:true,progressive_render:false,progressive_unload:false},_fn:{load_node:function(a,b,c){var d=this;this.load_node_json(a,function(){d.__callback({"obj":d._get_node(a)});b.call(this)},c)},_is_loaded:function(a){var s=this._get_settings().json_data;a=this._get_node(a);return a==-1||!a||(!s.ajax&&!s.progressive_render&&!$.isFunction(s.data))||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").length>0},refresh:function(a){a=this._get_node(a);var s=this._get_settings().json_data;if(a&&a!==-1&&s.progressive_unload&&($.isFunction(s.data)||!!s.ajax)){a.removeData("jstree_children")}return this.__call_old()},load_node_json:function(b,c,f){var s=this.get_settings().json_data,d,error_func=function(){},success_func=function(){};b=this._get_node(b);if(b&&b!==-1&&(s.progressive_render||s.progressive_unload)&&!b.is(".jstree-open, .jstree-leaf")&&b.children("ul").children("li").length===0&&b.data("jstree_children")){d=this._parse_json(b.data("jstree_children"),b);if(d){b.append(d);if(!s.progressive_unload){b.removeData("jstree_children")}}this.clean_node(b);if(c){c.call(this)}return}if(b&&b!==-1){if(b.data("jstree_is_loading")){return}else{b.data("jstree_is_loading",true)}}switch(!0){case(!s.data&&!s.ajax):throw"Neither data nor ajax settings supplied.";case($.isFunction(s.data)):s.data.call(this,b,$.proxy(function(d){d=this._parse_json(d,b);if(!d){if(b===-1||!b){if(s.correct_state){this.get_container().children("ul").empty()}}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(b)}}if(f){f.call(this)}}else{if(b===-1||!b){this.get_container().children("ul").empty().append(d.children())}else{b.append(d).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading")}this.clean_node(b);if(c){c.call(this)}}},this));break;case(!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!b||b===-1)):if(!b||b==-1){d=this._parse_json(s.data,b);if(d){this.get_container().children("ul").empty().append(d.children());this.clean_node()}else{if(s.correct_state){this.get_container().children("ul").empty()}}}if(c){c.call(this)}break;case(!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&b&&b!==-1):error_func=function(x,t,e){var a=this.get_settings().json_data.ajax.error;if(a){a.call(this,x,t,e)}if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(b)}}else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty()}}if(f){f.call(this)}};success_func=function(d,t,x){var a=this.get_settings().json_data.ajax.success;if(a){d=a.call(this,d,t,x)||d}if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")||(!$.isArray(d)&&!$.isPlainObject(d))){return error_func.call(this,x,t,"")}d=this._parse_json(d,b);if(d){if(b===-1||!b){this.get_container().children("ul").empty().append(d.children())}else{b.append(d).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading")}this.clean_node(b);if(c){c.call(this)}}else{if(b===-1||!b){if(s.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(b);if(c){c.call(this)}}}}};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="json"}if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,b)}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,b)}$.ajax(s.ajax);break}},_parse_json:function(a,b,c){var d=false,p=this._get_settings(),s=p.json_data,t=p.core.html_titles,tmp,i,j,ul1,ul2;if(!a){return d}if(s.progressive_unload&&b&&b!==-1){b.data("jstree_children",d)}if($.isArray(a)){d=$('<ul>');if(!a.length){return false}for(i=0,j=a.length;i<j;i++){tmp=this._parse_json(a[i],b,true);if(tmp.length){d=d.append(tmp)}}d=d.children()}else{if(typeof a=="string"){a={data:a}}if(!a.data&&a.data!==""){return d}d=$("<li />");if(a.attr){d.attr(a.attr)}if(a.metadata){d.data(a.metadata)}if(a.state){d.addClass("jstree-"+a.state)}if(!$.isArray(a.data)){tmp=a.data;a.data=[];a.data.push(tmp)}$.each(a.data,function(i,m){tmp=$("<a />");if($.isFunction(m)){m=m.call(this,a)}if(typeof m=="string"){tmp.attr('href','#')[t?"html":"text"](m)}else{if(!m.attr){m.attr={}}if(!m.attr.href){m.attr.href='#'}tmp.attr(m.attr)[t?"html":"text"](m.title);if(m.language){tmp.addClass(m.language)}}tmp.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!m.icon&&a.icon){m.icon=a.icon}if(m.icon){if(m.icon.indexOf("/")===-1){tmp.children("ins").addClass(m.icon)}else{tmp.children("ins").css("background","url('"+m.icon+"') center center no-repeat")}}d.append(tmp)});d.prepend("<ins class='jstree-icon'>&#160;</ins>");if(a.children){if(s.progressive_render&&a.state!=="open"){d.addClass("jstree-closed").data("jstree_children",a.children)}else{if(s.progressive_unload){d.data("jstree_children",a.children)}if($.isArray(a.children)&&a.children.length){tmp=this._parse_json(a.children,b,true);if(tmp.length){ul2=$("<ul />");ul2.append(tmp);d.append(ul2)}}}}}if(!c){ul1=$("<ul />");ul1.append(d);d=ul1}return d},get_json:function(b,c,d,e){var f=[],s=this._get_settings(),_this=this,tmp1,tmp2,li,a,t,lang;b=this._get_node(b);if(!b||b===-1){b=this.get_container().find("> ul > li")}c=$.isArray(c)?c:["id","class"];if(!e&&this.data.types){c.push(s.types.type_attr)}d=$.isArray(d)?d:[];b.each(function(){li=$(this);tmp1={data:[]};if(c.length){tmp1.attr={}}$.each(c,function(i,v){tmp2=li.attr(v);if(tmp2&&tmp2.length&&tmp2.replace(/jstree[^ ]*/ig,'').length){tmp1.attr[v]=(" "+tmp2).replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}});if(li.hasClass("jstree-open")){tmp1.state="open"}if(li.hasClass("jstree-closed")){tmp1.state="closed"}if(li.data()){tmp1.metadata=li.data()}a=li.children("a");a.each(function(){t=$(this);if(d.length||$.inArray("languages",s.plugins)!==-1||t.children("ins").get(0).style.backgroundImage.length||(t.children("ins").get(0).className&&t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').length)){lang=false;if($.inArray("languages",s.plugins)!==-1&&$.isArray(s.languages)&&s.languages.length){$.each(s.languages,function(l,a){if(t.hasClass(a)){lang=a;return false}})}tmp2={attr:{},title:_this.get_text(t,lang)};$.each(d,function(k,z){tmp2.attr[z]=(" "+(t.attr(z)||"")).replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")});if($.inArray("languages",s.plugins)!==-1&&$.isArray(s.languages)&&s.languages.length){$.each(s.languages,function(k,z){if(t.hasClass(z)){tmp2.language=z;return true}})}if(t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/^\s+$/ig,"").length){tmp2.icon=t.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}if(t.children("ins").get(0).style.backgroundImage.length){tmp2.icon=t.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}}else{tmp2=_this.get_text(t)}if(a.length>1){tmp1.data.push(tmp2)}else{tmp1.data=tmp2}});li=li.find("> ul > li");if(li.length){tmp1.children=_this.get_json(li,c,d,true)}f.push(tmp1)});return f}}})})(jQuery);(function($){var g=false;$.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(i){var a=this._get_settings().languages,st=false,selector=".jstree-"+this.get_index()+' a';if(!$.isArray(a)||a.length===0){return false}if($.inArray(i,a)==-1){if(!!a[i]){i=a[i]}else{return false}}if(i==this.data.languages.current_language){return true}st=$.vakata.css.get_css(selector+"."+this.data.languages.current_language,false,g);if(st!==false){st.style.display="none"}st=$.vakata.css.get_css(selector+"."+i,false,g);if(st!==false){st.style.display=""}this.data.languages.current_language=i;this.__callback(i);return true},get_lang:function(){return this.data.languages.current_language},_get_string:function(a,b){var c=this._get_settings().languages,s=this._get_settings().core.strings;if($.isArray(c)&&c.length){b=(b&&$.inArray(b,c)!=-1)?b:this.data.languages.current_language}if(s[b]&&s[b][a]){return s[b][a]}if(s[a]){return s[a]}return a},get_text:function(a,b){a=this._get_node(a)||this.data.ui.last_selected;if(!a.size()){return false}var c=this._get_settings().languages,s=this._get_settings().core.html_titles;if($.isArray(c)&&c.length){b=(b&&$.inArray(b,c)!=-1)?b:this.data.languages.current_language;a=a.children("a."+b)}else{a=a.children("a:eq(0)")}if(s){a=a.clone();a.children("INS").remove();return a.html()}else{a=a.contents().filter(function(){return this.nodeType==3})[0];return a.nodeValue}},set_text:function(a,b,c){a=this._get_node(a)||this.data.ui.last_selected;if(!a.size()){return false}var d=this._get_settings().languages,s=this._get_settings().core.html_titles,tmp;if($.isArray(d)&&d.length){c=(c&&$.inArray(c,d)!=-1)?c:this.data.languages.current_language;a=a.children("a."+c)}else{a=a.children("a:eq(0)")}if(s){tmp=a.children("INS").clone();a.html(b).prepend(tmp);this.__callback({"obj":a,"name":b,"lang":c});return true}else{a=a.contents().filter(function(){return this.nodeType==3})[0];this.__callback({"obj":a,"name":b,"lang":c});return(a.nodeValue=b)}},_load_css:function(){var a=this._get_settings().languages,str="/* languages css */",selector=".jstree-"+this.get_index()+' a',ln;if($.isArray(a)&&a.length){this.data.languages.current_language=a[0];for(ln=0;ln<a.length;ln++){str+=selector+"."+a[ln]+" {";if(a[ln]!=this.data.languages.current_language){str+=" display:none; "}str+=" } "}g=$.vakata.css.add_sheet({'str':str,'title':"jstree-languages"})}},create_node:function(c,d,e,f){var t=this.__call_old(true,c,d,e,function(t){var b=this._get_settings().languages,a=t.children("a"),ln;if($.isArray(b)&&b.length){for(ln=0;ln<b.length;ln++){if(!a.is("."+b[ln])){t.append(a.eq(0).clone().removeClass(b.join(" ")).addClass(b[ln]))}}a.not("."+b.join(", .")).remove()}if(f){f.call(this,t)}});return t}}})})(jQuery);(function($){$.jstree.plugin("cookies",{__init:function(){if(typeof $.cookie==="undefined"){throw"jsTree cookie: jQuery cookie plugin not included.";}var s=this._get_settings().cookies,tmp;if(!!s.save_loaded){tmp=$.cookie(s.save_loaded);if(tmp&&tmp.length){this.data.core.to_load=tmp.split(",")}}if(!!s.save_opened){tmp=$.cookie(s.save_opened);if(tmp&&tmp.length){this.data.core.to_open=tmp.split(",")}}if(!!s.save_selected){tmp=$.cookie(s.save_selected);if(tmp&&tmp.length&&this.data.ui){this.data.ui.to_select=tmp.split(",")}}this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",$.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",$.proxy(function(e){if(this._get_settings().cookies.auto_save){this.save_cookie((e.handleObj.namespace+e.handleObj.type).replace("jstree",""))}},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:true,cookie_options:{}},_fn:{save_cookie:function(c){if(this.data.core.refreshing){return}var s=this._get_settings().cookies;if(!c){if(s.save_loaded){this.save_loaded();$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options)}if(s.save_opened){this.save_opened();$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options)}if(s.save_selected&&this.data.ui){this.save_selected();$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options)}return}switch(c){case"open_node":case"close_node":if(!!s.save_opened){this.save_opened();$.cookie(s.save_opened,this.data.core.to_open.join(","),s.cookie_options)}if(!!s.save_loaded){this.save_loaded();$.cookie(s.save_loaded,this.data.core.to_load.join(","),s.cookie_options)}break;case"select_node":case"deselect_node":if(!!s.save_selected&&this.data.ui){this.save_selected();$.cookie(s.save_selected,this.data.ui.to_select.join(","),s.cookie_options)}break}}}})})(jQuery);(function($){$.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",$.proxy(function(e,a){var b=this._get_node(a.rslt.obj);b=b===-1?this.get_container().children("ul"):b.children("ul");this.sort(b)},this)).bind("rename_node.jstree create_node.jstree create.jstree",$.proxy(function(e,a){this.sort(a.rslt.obj.parent())},this)).bind("move_node.jstree",$.proxy(function(e,a){var m=a.rslt.np==-1?this.get_container():a.rslt.np;this.sort(m.children("ul"))},this))},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},_fn:{sort:function(a){var s=this._get_settings().sort,t=this;a.append($.makeArray(a.children("li")).sort($.proxy(s,t)));a.find("> li > ul").each(function(){t.sort($(this))});this.clean_node(a)}}})})(jQuery);(function($){var o=false,r=false,m=false,ml=false,sli=false,sti=false,dir1=false,dir2=false,last_pos=false;$.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(e,a,b){if($.vakata.dnd.is_drag){$.vakata.drag_stop({})}try{e.currentTarget.unselectable="on";e.currentTarget.onselectstart=function(){return false};if(e.currentTarget.style){e.currentTarget.style.MozUserSelect="none"}}catch(err){}$.vakata.dnd.init_x=e.pageX;$.vakata.dnd.init_y=e.pageY;$.vakata.dnd.user_data=a;$.vakata.dnd.is_down=true;$.vakata.dnd.helper=$("<div id='vakata-dragged' />").html(b);$(document).bind("mousemove",$.vakata.dnd.drag);$(document).bind("mouseup",$.vakata.dnd.drag_stop);return false},drag:function(e){if(!$.vakata.dnd.is_down){return}if(!$.vakata.dnd.is_drag){if(Math.abs(e.pageX-$.vakata.dnd.init_x)>5||Math.abs(e.pageY-$.vakata.dnd.init_y)>5){$.vakata.dnd.helper.appendTo("body");$.vakata.dnd.is_drag=true;$(document).triggerHandler("drag_start.vakata",{"event":e,"data":$.vakata.dnd.user_data})}else{return}}if(e.type==="mousemove"){var d=$(document),t=d.scrollTop(),l=d.scrollLeft();if(e.pageY-t<20){if(sti&&dir1==="down"){clearInterval(sti);sti=false}if(!sti){dir1="up";sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()-$.vakata.dnd.scroll_spd)},150)}}else{if(sti&&dir1==="up"){clearInterval(sti);sti=false}}if($(window).height()-(e.pageY-t)<20){if(sti&&dir1==="up"){clearInterval(sti);sti=false}if(!sti){dir1="down";sti=setInterval(function(){$(document).scrollTop($(document).scrollTop()+$.vakata.dnd.scroll_spd)},150)}}else{if(sti&&dir1==="down"){clearInterval(sti);sti=false}}if(e.pageX-l<20){if(sli&&dir2==="right"){clearInterval(sli);sli=false}if(!sli){dir2="left";sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()-$.vakata.dnd.scroll_spd)},150)}}else{if(sli&&dir2==="left"){clearInterval(sli);sli=false}}if($(window).width()-(e.pageX-l)<20){if(sli&&dir2==="left"){clearInterval(sli);sli=false}if(!sli){dir2="right";sli=setInterval(function(){$(document).scrollLeft($(document).scrollLeft()+$.vakata.dnd.scroll_spd)},150)}}else{if(sli&&dir2==="right"){clearInterval(sli);sli=false}}}$.vakata.dnd.helper.css({left:(e.pageX+$.vakata.dnd.helper_left)+"px",top:(e.pageY+$.vakata.dnd.helper_top)+"px"});$(document).triggerHandler("drag.vakata",{"event":e,"data":$.vakata.dnd.user_data})},drag_stop:function(e){if(sli){clearInterval(sli)}if(sti){clearInterval(sti)}$(document).unbind("mousemove",$.vakata.dnd.drag);$(document).unbind("mouseup",$.vakata.dnd.drag_stop);$(document).triggerHandler("drag_stop.vakata",{"event":e,"data":$.vakata.dnd.user_data});$.vakata.dnd.helper.remove();$.vakata.dnd.init_x=0;$.vakata.dnd.init_y=0;$.vakata.dnd.user_data={};$.vakata.dnd.is_down=false;$.vakata.dnd.is_drag=false}};$(function(){var a='#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ';$.vakata.css.add_sheet({str:a,title:"vakata"})});$.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false,mto:false};this.get_container().bind("mouseenter.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(this.data.themes){m.attr("class","jstree-"+this.data.themes.theme);if(ml){ml.attr("class","jstree-"+this.data.themes.theme)}$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}if(e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var a=$.jstree._reference(e.target),dc;if(a.data.dnd.foreign){dc=a._get_settings().dnd.drag_check.call(this,{"o":o,"r":a.get_container(),is_root:true});if(dc===true||dc.inside===true||dc.before===true||dc.after===true){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}else{a.prepare_move(o,a.get_container(),"last");if(a.check_move()){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}}}},this)).bind("mouseup.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&e.currentTarget===e.target&&$.vakata.dnd.user_data.obj&&$($.vakata.dnd.user_data.obj).length&&$($.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==e.target){var a=$.jstree._reference(e.currentTarget),dc;if(a.data.dnd.foreign){dc=a._get_settings().dnd.drag_check.call(this,{"o":o,"r":a.get_container(),is_root:true});if(dc===true||dc.inside===true||dc.before===true||dc.after===true){a._get_settings().dnd.drag_finish.call(this,{"o":o,"r":a.get_container(),is_root:true})}}else{a.move_node(o,a.get_container(),"last",e[a._get_settings().dnd.copy_modifier+"Key"])}}},this)).bind("mouseleave.jstree",$.proxy(function(e){if(e.relatedTarget&&e.relatedTarget.id&&e.relatedTarget.id==="jstree-marker-line"){return false}if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if($.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}}},this)).bind("mousemove.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){var a=this.get_container()[0];if(e.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft+=$.vakata.dnd.scroll_spd},a),100)}else if(e.pageX-24<this.data.dnd.cof.left){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval($.proxy(function(){this.scrollLeft-=$.vakata.dnd.scroll_spd},a),100)}else{if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}}if(e.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop+=$.vakata.dnd.scroll_spd},a),100)}else if(e.pageY-24<this.data.dnd.cof.top){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval($.proxy(function(){this.scrollTop-=$.vakata.dnd.scroll_spd},a),100)}else{if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}}}},this)).bind("scroll.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree&&m&&ml){m.hide();ml.hide()}},this)).delegate("a","mousedown.jstree",$.proxy(function(e){if(e.which===1){this.start_drag(e.currentTarget,e);return false}},this)).delegate("a","mouseenter.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){this.dnd_enter(e.currentTarget)}},this)).delegate("a","mousemove.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(!r||!r.length||r.children("a")[0]!==e.currentTarget){this.dnd_enter(e.currentTarget)}if(typeof this.data.dnd.off.top==="undefined"){this.data.dnd.off=$(e.target).offset()}this.data.dnd.w=(e.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0){this.data.dnd.w+=this.data.core.li_height}this.dnd_show()}},this)).delegate("a","mouseleave.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){if(e.relatedTarget&&e.relatedTarget.id&&e.relatedTarget.id==="jstree-marker-line"){return false}if(m){m.hide()}if(ml){ml.hide()}this.data.dnd.mto=setTimeout((function(t){return function(){t.dnd_leave(e)}})(this),0)}},this)).delegate("a","mouseup.jstree",$.proxy(function(e){if($.vakata.dnd.is_drag&&$.vakata.dnd.user_data.jstree){this.dnd_finish(e)}},this));$(document).bind("drag_stop.vakata",$.proxy(function(){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.i1=false;this.data.dnd.i2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;if(m){m.css({"top":"-2000px"})}if(ml){ml.css({"top":"-2000px"})}},this)).bind("drag_start.vakata",$.proxy(function(e,a){if(a.data.jstree){var b=$(a.event.target);if(b.closest(".jstree").hasClass("jstree-"+this.get_index())){this.dnd_enter(b)}}},this));var s=this._get_settings().dnd;if(s.drag_target){$(document).delegate(s.drag_target,"mousedown.jstree-"+this.get_index(),$.proxy(function(e){o=e.target;$.vakata.dnd.drag_start(e,{jstree:true,obj:e.target},"<ins class='jstree-icon'></ins>"+$(e.target).text());if(this.data.themes){if(m){m.attr("class","jstree-"+this.data.themes.theme)}if(ml){ml.attr("class","jstree-"+this.data.themes.theme)}$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var a=this.get_container();this.data.dnd.cof=a.offset();this.data.dnd.cw=parseInt(a.width(),10);this.data.dnd.ch=parseInt(a.height(),10);this.data.dnd.foreign=true;e.preventDefault()},this))}if(s.drop_target){$(document).delegate(s.drop_target,"mouseenter.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{"o":o,"r":$(e.target),"e":e})){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}},this)).delegate(s.drop_target,"mouseleave.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}},this)).delegate(s.drop_target,"mouseup.jstree-"+this.get_index(),$.proxy(function(e){if(this.data.dnd.active&&$.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){this._get_settings().dnd.drop_finish.call(this,{"o":o,"r":$(e.target),"e":e})}},this))}},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(a){return true},drop_finish:$.noop,drag_target:".jstree-draggable",drag_finish:$.noop,drag_check:function(a){return{after:false,before:false,inside:true}}},_fn:{dnd_prepare:function(){if(!r||!r.length){return}this.data.dnd.off=r.offset();if(this._get_settings().core.rtl){this.data.dnd.off.right=this.data.dnd.off.left+r.width()}if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{"o":o,"r":r});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=a.inside;this.data.dnd.prepared=true;return this.dnd_show()}this.prepare_move(o,r,"before");this.data.dnd.before=this.check_move();this.prepare_move(o,r,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(r)){this.prepare_move(o,r,"inside");this.data.dnd.inside=this.check_move()}else{this.data.dnd.inside=false}this.data.dnd.prepared=true;return this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared){return}var o=["before","inside","after"],r=false,rtl=this._get_settings().core.rtl,pos;if(this.data.dnd.w<this.data.core.li_height/3){o=["before","inside","after"]}else if(this.data.dnd.w<=this.data.core.li_height*2/3){o=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]}else{o=["after","inside","before"]}$.each(o,$.proxy(function(i,a){if(this.data.dnd[a]){$.vakata.dnd.helper.children("ins").attr("class","jstree-ok");r=a;return false}},this));if(r===false){$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}pos=rtl?(this.data.dnd.off.right-18):(this.data.dnd.off.left+10);switch(r){case"before":m.css({"left":pos+"px","top":(this.data.dnd.off.top-6)+"px"}).show();if(ml){ml.css({"left":(pos+8)+"px","top":(this.data.dnd.off.top-1)+"px"}).show()}break;case"after":m.css({"left":pos+"px","top":(this.data.dnd.off.top+this.data.core.li_height-6)+"px"}).show();if(ml){ml.css({"left":(pos+8)+"px","top":(this.data.dnd.off.top+this.data.core.li_height-1)+"px"}).show()}break;case"inside":m.css({"left":pos+(rtl?-4:4)+"px","top":(this.data.dnd.off.top+this.data.core.li_height/2-5)+"px"}).show();if(ml){ml.hide()}break;default:m.hide();if(ml){ml.hide()}break}last_pos=r;return r},dnd_open:function(){this.data.dnd.to2=false;this.open_node(r,$.proxy(this.dnd_prepare,this),true)},dnd_finish:function(e){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside){this._get_settings().dnd.drag_finish.call(this,{"o":o,"r":r,"p":last_pos})}}else{this.dnd_prepare();this.move_node(o,r,last_pos,e[this._get_settings().dnd.copy_modifier+"Key"])}o=false;r=false;m.hide();if(ml){ml.hide()}},dnd_enter:function(a){if(this.data.dnd.mto){clearTimeout(this.data.dnd.mto);this.data.dnd.mto=false}var s=this._get_settings().dnd;this.data.dnd.prepared=false;r=this._get_node(a);if(s.check_timeout){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}this.data.dnd.to1=setTimeout($.proxy(this.dnd_prepare,this),s.check_timeout)}else{this.dnd_prepare()}if(s.open_timeout){if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(r&&r.length&&r.hasClass("jstree-closed")){this.data.dnd.to2=setTimeout($.proxy(this.dnd_open,this),s.open_timeout)}}else{if(r&&r.length&&r.hasClass("jstree-closed")){this.dnd_open()}}},dnd_leave:function(e){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;$.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");m.hide();if(ml){ml.hide()}if(r&&r[0]===e.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false}}},start_drag:function(a,e){o=this._get_node(a);if(this.data.ui&&this.is_selected(o)){o=this._get_node(null,true)}var b=o.length>1?this._get_string("multiple_selection"):this.get_text(o),cnt=this.get_container();if(!this._get_settings().core.html_titles){b=b.replace(/</ig,"&lt;").replace(/>/ig,"&gt;")}$.vakata.dnd.drag_start(e,{jstree:true,obj:o},"<ins class='jstree-icon'></ins>"+b);if(this.data.themes){if(m){m.attr("class","jstree-"+this.data.themes.theme)}if(ml){ml.attr("class","jstree-"+this.data.themes.theme)}$.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}this.data.dnd.cof=cnt.offset();this.data.dnd.cw=parseInt(cnt.width(),10);this.data.dnd.ch=parseInt(cnt.height(),10);this.data.dnd.active=true}}});$(function(){var b=''+'#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; '+' -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; '+'} '+'#vakata-dragged .jstree-ok { background:green; } '+'#vakata-dragged .jstree-invalid { background:red; } '+'#jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } '+'#jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43; '+' cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666; '+' -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; '+'}'+'';$.vakata.css.add_sheet({str:b,title:"jstree"});m=$("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(e){m.hide();ml.hide();e.preventDefault();e.stopImmediatePropagation();return false}).appendTo("body");ml=$("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(e){if(r&&r.length){r.children("a").trigger(e);e.preventDefault();e.stopImmediatePropagation();return false}}).bind("mouseleave",function(e){var a=$(e.relatedTarget);if(a.is(".jstree")||a.closest(".jstree").length===0){if(r&&r.length){r.children("a").trigger(e);m.hide();ml.hide();e.preventDefault();e.stopImmediatePropagation();return false}}}).appendTo("body");$(document).bind("drag_start.vakata",function(e,a){if(a.data.jstree){m.show();if(ml){ml.show()}}});$(document).bind("drag_stop.vakata",function(e,a){if(a.data.jstree){m.hide();if(ml){ml.hide()}}})})})(jQuery);(function($){$.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;if(this.data.ui&&this.data.checkbox.noui){this.select_node=this.deselect_node=this.deselect_all=$.noop;this.get_selected=this.get_checked}this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",$.proxy(function(e,a){this._prepare_checkboxes(a.rslt.obj)},this)).bind("loaded.jstree",$.proxy(function(e){this._prepare_checkboxes()},this)).delegate((this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox"),"click.jstree",$.proxy(function(e){e.preventDefault();if(this._get_node(e.target).hasClass("jstree-checked")){this.uncheck_node(e.target)}else{this.check_node(e.target)}if(this.data.ui&&this.data.checkbox.noui){this.save_selected();if(this.data.cookies){this.save_cookie("select_node")}}else{e.stopImmediatePropagation();return false}},this))},defaults:{override_ui:false,two_state:false,real_checkboxes:false,checked_parent_open:true,real_checkboxes_names:function(n){return[("check_"+(n[0].id||Math.ceil(Math.random()*10000))),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(n,a){if(a.checked){this.check_node(n,false)}},_prepare_checkboxes:function(b){b=!b||b==-1?this.get_container().find("> ul > li"):this._get_node(b);if(b===false){return}var c,_this=this,t,ts=this._get_settings().checkbox.two_state,rc=this._get_settings().checkbox.real_checkboxes,rcn=this._get_settings().checkbox.real_checkboxes_names;b.each(function(){t=$(this);c=t.is("li")&&(t.hasClass("jstree-checked")||(rc&&t.children(":checked").length))?"jstree-checked":"jstree-unchecked";t.find("li").addBack().each(function(){var a=$(this),nm;a.children("a"+(_this.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(ts?"jstree-unchecked":c);if(rc){if(!a.children(":checkbox").length){nm=rcn.call(_this,a);a.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+nm[0]+"' name='"+nm[0]+"' value='"+nm[1]+"' />")}else{a.children(":checkbox").addClass("jstree-real-checkbox")}}if(!ts){if(c==="jstree-checked"||a.hasClass("jstree-checked")||a.children(':checked').length){a.find("li").addBack().addClass("jstree-checked").children(":checkbox").prop("checked",true)}}else{if(a.hasClass("jstree-checked")||a.children(':checked').length){a.addClass("jstree-checked").children(":checkbox").prop("checked",true)}}})});if(!ts){b.find(".jstree-checked").parent().parent().each(function(){_this._repair_state(this)})}},change_state:function(b,c){b=this._get_node(b);var d=false,rc=this._get_settings().checkbox.real_checkboxes;if(!b||b===-1){return false}c=(c===false||c===true)?c:b.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state){if(c){b.removeClass("jstree-checked").addClass("jstree-unchecked");if(rc){b.children(":checkbox").prop("checked",false)}}else{b.removeClass("jstree-unchecked").addClass("jstree-checked");if(rc){b.children(":checkbox").prop("checked",true)}}}else{if(c){d=b.find("li").addBack();if(!d.filter(".jstree-checked, .jstree-undetermined").length){return false}d.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(rc){d.children(":checkbox").prop("checked",false)}}else{d=b.find("li").addBack();if(!d.filter(".jstree-unchecked, .jstree-undetermined").length){return false}d.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(rc){d.children(":checkbox").prop("checked",true)}if(this.data.ui){this.data.ui.last_selected=b}this.data.checkbox.last_selected=b}b.parentsUntil(".jstree","li").each(function(){var a=$(this);if(c){if(a.children("ul").children("li.jstree-checked, li.jstree-undetermined").length){a.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){a.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",false)}return false}else{a.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(rc){a.children(":checkbox").prop("checked",false)}}}else{if(a.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length){a.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(rc){a.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",false)}return false}else{a.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(rc){a.children(":checkbox").prop("checked",true)}}}})}if(this.data.ui&&this.data.checkbox.noui){this.data.ui.selected=this.get_checked()}this.__callback(b);return true},check_node:function(a){if(this.change_state(a,false)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var t=this;a.parents(".jstree-closed").each(function(){t.open_node(this,false,true)})}this.__callback({"obj":a})}},uncheck_node:function(a){if(this.change_state(a,true)){this.__callback({"obj":this._get_node(a)})}},check_all:function(){var a=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){a.change_state(this,false)});this.__callback()},uncheck_all:function(){var a=this,coll=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");coll.each(function(){a.change_state(this,true)});this.__callback()},is_checked:function(a){a=this._get_node(a);return a.length?a.is(".jstree-checked"):false},get_checked:function(a,b){a=!a||a===-1?this.get_container():this._get_node(a);return b||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,b){a=!a||a===-1?this.get_container():this._get_node(a);return b||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(d){d=this._get_node(d);if(!d.length){return}if(this._get_settings().checkbox.two_state){d.find('li').addBack().not('.jstree-checked').removeClass('jstree-undetermined').addClass('jstree-unchecked').children(':checkbox').prop('checked',true);return}var e=this._get_settings().checkbox.real_checkboxes,a=d.find("> ul > .jstree-checked").length,b=d.find("> ul > .jstree-undetermined").length,c=d.find("> ul > li").length;if(c===0){if(d.hasClass("jstree-undetermined")){this.change_state(d,false)}}else if(a===0&&b===0){this.change_state(d,true)}else if(a===c){this.change_state(d,false)}else{d.parentsUntil(".jstree","li").addBack().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(e){d.parentsUntil(".jstree","li").addBack().children(":checkbox").prop("checked",false)}}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var b=this,s=this.data.ui.to_select;s=$.map($.makeArray(s),function(n){return"#"+n.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();$.each(s,function(i,a){b.check_node(a)});this.__callback()}else{this.__call_old()}},save_loaded:function(){var a=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){if(this.id){a.data.core.to_load.push("#"+this.id)}})}}});$(function(){var a='.jstree .jstree-real-checkbox { display:none; } ';$.vakata.css.add_sheet({str:a,title:"jstree"})})})(jQuery);(function($){$.vakata.xslt=function(a,b,c){var r=false,p,q,s;if(r===false&&(window.ActiveXObject||"ActiveXObject"in window)){try{r=new ActiveXObject("Msxml2.XSLTemplate");q=new ActiveXObject("Msxml2.DOMDocument");q.loadXML(a);s=new ActiveXObject("Msxml2.FreeThreadedDOMDocument");s.loadXML(b);r.stylesheet=s;p=r.createProcessor();p.input=q;p.transform();r=p.output}catch(e){}}a=$.parseXML(a);b=$.parseXML(b);if(r===false&&typeof(XSLTProcessor)!=="undefined"){p=new XSLTProcessor();p.importStylesheet(b);r=p.transformToFragment(a,document);r=$('<div />').append(r).html()}if(r===false&&typeof(a.transformNode)!=="undefined"){r=a.transformNode(b)}c.call(null,r)};var h={'nest':'<'+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" />'+'<xsl:template match="/">'+'	<xsl:call-template name="nodes">'+'		<xsl:with-param name="node" select="/root" />'+'	</xsl:call-template>'+'</xsl:template>'+'<xsl:template name="nodes">'+'	<xsl:param name="node" />'+'	<ul>'+'	<xsl:for-each select="$node/item">'+'		<xsl:variable name="children" select="count(./item) &gt; 0" />'+'		<li>'+'			<xsl:attribute name="class">'+'				<xsl:if test="position() = last()">jstree-last </xsl:if>'+'				<xsl:choose>'+'					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>'+'					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>'+'					<xsl:otherwise>jstree-leaf </xsl:otherwise>'+'				</xsl:choose>'+'				<xsl:value-of select="@class" />'+'			</xsl:attribute>'+'			<xsl:for-each select="@*">'+'				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">'+'					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'				</xsl:if>'+'			</xsl:for-each>'+'	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+'			<xsl:for-each select="content/name">'+'				<a>'+'				<xsl:attribute name="href">'+'					<xsl:choose>'+'					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+'					<xsl:otherwise>#</xsl:otherwise>'+'					</xsl:choose>'+'				</xsl:attribute>'+'				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'				<xsl:for-each select="@*">'+'					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">'+'						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'					</xsl:if>'+'				</xsl:for-each>'+'					<ins>'+'						<xsl:attribute name="class">jstree-icon '+'							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+'						</xsl:attribute>'+'						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+'						<xsl:text>&#xa0;</xsl:text>'+'					</ins>'+'					<xsl:copy-of select="./child::node()" />'+'				</a>'+'			</xsl:for-each>'+'			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>'+'		</li>'+'	</xsl:for-each>'+'	</ul>'+'</xsl:template>'+'</xsl:stylesheet>','flat':'<'+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" />'+'<xsl:template match="/">'+'	<ul>'+'	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">'+'		<xsl:call-template name="nodes">'+'			<xsl:with-param name="node" select="." />'+'			<xsl:with-param name="is_last" select="number(position() = last())" />'+'		</xsl:call-template>'+'	</xsl:for-each>'+'	</ul>'+'</xsl:template>'+'<xsl:template name="nodes">'+'	<xsl:param name="node" />'+'	<xsl:param name="is_last" />'+'	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />'+'	<li>'+'	<xsl:attribute name="class">'+'		<xsl:if test="$is_last = true()">jstree-last </xsl:if>'+'		<xsl:choose>'+'			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>'+'			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>'+'			<xsl:otherwise>jstree-leaf </xsl:otherwise>'+'		</xsl:choose>'+'		<xsl:value-of select="@class" />'+'	</xsl:attribute>'+'	<xsl:for-each select="@*">'+'		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">'+'		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'		</xsl:if>'+'	</xsl:for-each>'+'	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+'	<xsl:for-each select="content/name">'+'		<a>'+'		<xsl:attribute name="href">'+'			<xsl:choose>'+'			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+'			<xsl:otherwise>#</xsl:otherwise>'+'			</xsl:choose>'+'		</xsl:attribute>'+'		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'		<xsl:for-each select="@*">'+'			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">'+'				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+'			</xsl:if>'+'		</xsl:for-each>'+'			<ins>'+'				<xsl:attribute name="class">jstree-icon '+'					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+'				</xsl:attribute>'+'				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+'				<xsl:text>&#xa0;</xsl:text>'+'			</ins>'+'			<xsl:copy-of select="./child::node()" />'+'		</a>'+'	</xsl:for-each>'+'	<xsl:if test="$children">'+'		<ul>'+'		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">'+'			<xsl:call-template name="nodes">'+'				<xsl:with-param name="node" select="." />'+'				<xsl:with-param name="is_last" select="number(position() = last())" />'+'			</xsl:call-template>'+'		</xsl:for-each>'+'		</ul>'+'	</xsl:if>'+'	</li>'+'</xsl:template>'+'</xsl:stylesheet>'},escape_xml=function(a){return a.toString().replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&apos;')};$.jstree.plugin("xml_data",{defaults:{data:false,ajax:false,xsl:"flat",clean_node:false,correct_state:true,get_skip_empty:false,get_include_preamble:true},_fn:{load_node:function(a,b,c){var d=this;this.load_node_xml(a,function(){d.__callback({"obj":d._get_node(a)});b.call(this)},c)},_is_loaded:function(a){var s=this._get_settings().xml_data;a=this._get_node(a);return a==-1||!a||(!s.ajax&&!$.isFunction(s.data))||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_xml:function(b,c,f){var s=this.get_settings().xml_data,error_func=function(){},success_func=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree_is_loading")){return}else{b.data("jstree_is_loading",true)}}switch(!0){case(!s.data&&!s.ajax):throw"Neither data nor ajax settings supplied.";case($.isFunction(s.data)):s.data.call(this,b,$.proxy(function(d){this.parse_xml(d,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);if(b===-1||!b){this.get_container().children("ul").empty().append(d.children())}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d);b.removeData("jstree_is_loading")}if(s.clean_node){this.clean_node(b)}if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}}},this))},this));break;case(!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!b||b===-1)):if(!b||b==-1){this.parse_xml(s.data,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);this.get_container().children("ul").empty().append(d.children());if(s.clean_node){this.clean_node(b)}if(c){c.call(this)}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}},this))}break;case(!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&b&&b!==-1):error_func=function(x,t,e){var a=this.get_settings().xml_data.ajax.error;if(a){a.call(this,x,t,e)}if(b!==-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(b)}}else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty()}}if(f){f.call(this)}};success_func=function(d,t,x){d=x.responseText;var a=this.get_settings().xml_data.ajax.success;if(a){d=a.call(this,d,t,x)||d}if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")){return error_func.call(this,x,t,"")}this.parse_xml(d,$.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=$(d);if(b===-1||!b){this.get_container().children("ul").empty().append(d.children())}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d);b.removeData("jstree_is_loading")}if(s.clean_node){this.clean_node(b)}if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}}},this))};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="xml"}if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,b)}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,b)}$.ajax(s.ajax);break}},parse_xml:function(a,b){var s=this._get_settings().xml_data;$.vakata.xslt(a,h[s.xsl],b)},get_xml:function(b,c,d,e,f){var g="",s=this._get_settings(),_this=this,tmp1,tmp2,li,a,lang;if(!b){b="flat"}if(!f){f=0}c=this._get_node(c);if(!c||c===-1){c=this.get_container().find("> ul > li")}d=$.isArray(d)?d:["id","class"];if(!f&&this.data.types&&$.inArray(s.types.type_attr,d)===-1){d.push(s.types.type_attr)}e=$.isArray(e)?e:[];if(!f){if(s.xml_data.get_include_preamble){g+='<'+'?xml version="1.0" encoding="UTF-8"?'+'>'}g+="<root>"}c.each(function(){g+="<item";li=$(this);$.each(d,function(i,v){var t=li.attr(v);if(!s.xml_data.get_skip_empty||typeof t!=="undefined"){g+=" "+v+"=\""+escape_xml((" "+(t||"")).replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+"\""}});if(li.hasClass("jstree-open")){g+=" state=\"open\""}if(li.hasClass("jstree-closed")){g+=" state=\"closed\""}if(b==="flat"){g+=" parent_id=\""+escape_xml(f)+"\""}g+=">";g+="<content>";a=li.children("a");a.each(function(){tmp1=$(this);lang=false;g+="<name";if($.inArray("languages",s.plugins)!==-1){$.each(s.languages,function(k,z){if(tmp1.hasClass(z)){g+=" lang=\""+escape_xml(z)+"\"";lang=z;return false}})}if(e.length){$.each(e,function(k,z){var t=tmp1.attr(z);if(!s.xml_data.get_skip_empty||typeof t!=="undefined"){g+=" "+z+"=\""+escape_xml((" "+t||"").replace(/ jstree[^ ]*/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+"\""}})}if(tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/^\s+$/ig,"").length){g+=' icon="'+escape_xml(tmp1.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,'').replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}if(tmp1.children("ins").get(0).style.backgroundImage.length){g+=' icon="'+escape_xml(tmp1.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'}g+=">";g+="<![CDATA["+_this.get_text(tmp1,lang)+"]]>";g+="</name>"});g+="</content>";tmp2=li[0].id||true;li=li.find("> ul > li");if(li.length){tmp2=_this.get_xml(b,li,d,e,tmp2)}else{tmp2=""}if(b=="nest"){g+=tmp2}g+="</item>";if(b=="flat"){g+=tmp2}});if(!f){g+="</root>"}return g}}})})(jQuery);(function($){if($().jquery.split('.')[1]>=8){$.expr[':'].jstree_contains=$.expr.createPseudo(function(b){return function(a){return(a.textContent||a.innerText||"").toLowerCase().indexOf(b.toLowerCase())>=0}});$.expr[':'].jstree_title_contains=$.expr.createPseudo(function(b){return function(a){return(a.getAttribute("title")||"").toLowerCase().indexOf(b.toLowerCase())>=0}})}else{$.expr[':'].jstree_contains=function(a,i,m){return(a.textContent||a.innerText||"").toLowerCase().indexOf(m[3].toLowerCase())>=0};$.expr[':'].jstree_title_contains=function(a,i,m){return(a.getAttribute("title")||"").toLowerCase().indexOf(m[3].toLowerCase())>=0}}$.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=$();if(this._get_settings().search.show_only_matches){this.get_container().bind("search.jstree",function(e,a){$(this).children("ul").find("li").hide().removeClass("jstree-last");a.rslt.nodes.parentsUntil(".jstree").addBack().show().filter("ul").each(function(){$(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){$(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})}},defaults:{ajax:false,search_method:"jstree_contains",show_only_matches:false},_fn:{search:function(b,c){if($.trim(b)===""){this.clear_search();return}var s=this.get_settings().search,t=this,error_func=function(){},success_func=function(){};this.data.search.str=b;if(!c&&s.ajax!==false&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=true;error_func=function(){};success_func=function(d,t,x){var a=this.get_settings().search.ajax.success;if(a){d=a.call(this,d,t,x)||d}this.data.search.to_open=d;this._search_open()};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,b)}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,b)}if(!s.ajax.data){s.ajax.data={"search_string":b}}if(!s.ajax.dataType||/^json/.exec(s.ajax.dataType)){s.ajax.dataType="json"}$.ajax(s.ajax);return}if(this.data.search.result.length){this.clear_search()}this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(s.search_method)+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){t.open_node(this,false,true)});this.__callback({nodes:this.data.search.result,str:b})},clear_search:function(a){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=$()},_search_open:function(b){var c=this,done=true,current=[],remaining=[];if(this.data.search.to_open.length){$.each(this.data.search.to_open,function(i,a){if(a=="#"){return true}if($(a).length&&$(a).is(".jstree-closed")){current.push(a)}else{remaining.push(a)}});if(current.length){this.data.search.to_open=remaining;$.each(current,function(i,a){c.open_node(a,function(){c._search_open(true)})});done=false}}if(done){this.search(this.data.search.str,true)}}}})})(jQuery);(function($){$.vakata.context={hide_on_mouseleave:false,cnt:$("<div id='vakata-contextmenu' />"),vis:false,tgt:false,par:false,func:false,data:false,rtl:false,show:function(s,t,x,y,d,p,a){$.vakata.context.rtl=!!a;var b=$.vakata.context.parse(s),h,w;if(!b){return}$.vakata.context.vis=true;$.vakata.context.tgt=t;$.vakata.context.par=p||t||null;$.vakata.context.data=d||null;$.vakata.context.cnt.html(b).css({"visibility":"hidden","display":"block","left":0,"top":0});if($.vakata.context.hide_on_mouseleave){$.vakata.context.cnt.one("mouseleave",function(e){$.vakata.context.hide()})}h=$.vakata.context.cnt.height();w=$.vakata.context.cnt.width();if(x+w>$(document).width()){x=$(document).width()-(w+5);$.vakata.context.cnt.find("li > ul").addClass("right")}if(y+h>$(document).height()){y=y-(h+t[0].offsetHeight);$.vakata.context.cnt.find("li > ul").addClass("bottom")}$.vakata.context.cnt.css({"left":x,"top":y}).find("li:has(ul)").bind("mouseenter",function(e){var w=$(document).width(),h=$(document).height(),ul=$(this).children("ul").show();if(w!==$(document).width()){ul.toggleClass("right")}if(h!==$(document).height()){ul.toggleClass("bottom")}}).bind("mouseleave",function(e){$(this).children("ul").hide()}).end().css({"visibility":"visible"}).show();$(document).triggerHandler("context_show.vakata")},hide:function(){$.vakata.context.vis=false;$.vakata.context.cnt.attr("class","").css({"visibility":"hidden"});$(document).triggerHandler("context_hide.vakata")},parse:function(s,b){if(!s){return false}var c="",tmp=false,was_sep=true;if(!b){$.vakata.context.func={}}c+="<ul>";$.each(s,function(i,a){if(!a){return true}$.vakata.context.func[i]=a.action;if(!was_sep&&a.separator_before){c+="<li class='vakata-separator vakata-separator-before'></li>"}was_sep=false;c+="<li class='"+(a._class||"")+(a._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";if(a.icon&&a.icon.indexOf("/")===-1){c+=" class='"+a.icon+"' "}if(a.icon&&a.icon.indexOf("/")!==-1){c+=" style='background:url("+a.icon+") center center no-repeat;' "}c+=">&#160;</ins><a href='#' rel='"+i+"'>";if(a.submenu){c+="<span style='float:"+($.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"}c+=a.label+"</a>";if(a.submenu){tmp=$.vakata.context.parse(a.submenu,true);if(tmp){c+=tmp}}c+="</li>";if(a.separator_after){c+="<li class='vakata-separator vakata-separator-after'></li>";was_sep=true}});c=c.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");c+="</ul>";$(document).triggerHandler("context_parse.vakata");return c.length>10?c:false},exec:function(i){if($.isFunction($.vakata.context.func[i])){$.vakata.context.func[i].call($.vakata.context.data,$.vakata.context.par);return true}else{return false}}};$(function(){var a=''+'#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } '+'#vakata-contextmenu ul { min-width:180px; *width:180px; } '+'#vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } '+'#vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } '+'#vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } '+'#vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } '+'#vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } '+'#vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } '+'#vakata-contextmenu .right { right:100%; left:auto; } '+'#vakata-contextmenu .bottom { bottom:-1px; top:auto; } '+'#vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ';$.vakata.css.add_sheet({str:a,title:"vakata"});$.vakata.context.cnt.delegate("a","click",function(e){e.preventDefault()}).delegate("a","mouseup",function(e){if(!$(this).parent().hasClass("jstree-contextmenu-disabled")&&$.vakata.context.exec($(this).attr("rel"))){$.vakata.context.hide()}else{$(this).blur()}}).delegate("a","mouseover",function(){$.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");$(document).bind("mousedown",function(e){if($.vakata.context.vis&&!$.contains($.vakata.context.cnt[0],e.target)){$.vakata.context.hide()}});if(typeof $.hotkeys!=="undefined"){$(document).bind("keydown","up",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();if(!o.length){o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()}o.addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault()}}).bind("keydown","down",function(e){if($.vakata.context.vis){var o=$.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();if(!o.length){o=$.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()}o.addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault()}}).bind("keydown","right",function(e){if($.vakata.context.vis){$.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault()}}).bind("keydown","left",function(e){if($.vakata.context.vis){$.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");e.stopImmediatePropagation();e.preventDefault()}}).bind("keydown","esc",function(e){$.vakata.context.hide();e.preventDefault()}).bind("keydown","space",function(e){$.vakata.context.cnt.find(".vakata-hover").last().children("a").click();e.preventDefault()})}});$.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",$.proxy(function(e){e.preventDefault();if(!$(e.currentTarget).hasClass("jstree-loading")){this.show_contextmenu(e.currentTarget,e.pageX,e.pageY)}},this)).delegate("a","click.jstree",$.proxy(function(e){if(this.data.contextmenu){$.vakata.context.hide()}},this)).bind("destroy.jstree",$.proxy(function(){if(this.data.contextmenu){$.vakata.context.hide()}},this));$(document).bind("context_hide.vakata",$.proxy(function(){this.data.contextmenu=false},this))},defaults:{select_node:false,show_at_node:true,items:{"create":{"separator_before":false,"separator_after":true,"label":"Create","action":function(a){this.create(a)}},"rename":{"separator_before":false,"separator_after":false,"label":"Rename","action":function(a){this.rename(a)}},"remove":{"separator_before":false,"icon":false,"separator_after":false,"label":"Delete","action":function(a){if(this.is_selected(a)){this.remove()}else{this.remove(a)}}},"ccp":{"separator_before":true,"icon":false,"separator_after":false,"label":"Edit","action":false,"submenu":{"cut":{"separator_before":false,"separator_after":false,"label":"Cut","action":function(a){this.cut(a)}},"copy":{"separator_before":false,"icon":false,"separator_after":false,"label":"Copy","action":function(a){this.copy(a)}},"paste":{"separator_before":false,"icon":false,"separator_after":false,"label":"Paste","action":function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(b,x,y){b=this._get_node(b);var s=this.get_settings().contextmenu,a=b.children("a:visible:eq(0)"),o=false,i=false;if(s.select_node&&this.data.ui&&!this.is_selected(b)){this.deselect_all();this.select_node(b,true)}if(s.show_at_node||typeof x==="undefined"||typeof y==="undefined"){o=a.offset();x=o.left;y=o.top+this.data.core.li_height}i=b.data("jstree")&&b.data("jstree").contextmenu?b.data("jstree").contextmenu:s.items;if($.isFunction(i)){i=i.call(this,b)}this.data.contextmenu=true;$.vakata.context.show(i,a,x,y,this,b,this._get_settings().core.rtl);if(this.data.themes){$.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}}})})(jQuery);(function($){$.jstree.plugin("types",{__init:function(){var s=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",$.proxy(function(){var b=s.types,attr=s.type_attr,icons_css="",_this=this;$.each(b,function(i,a){$.each(a,function(k,v){if(!/^(max_depth|max_children|icon|valid_children)$/.test(k)){_this.data.types.attach_to.push(k)}});if(!a.icon){return true}if(a.icon.image||a.icon.position){if(i=="default"){icons_css+='.jstree-'+_this.get_index()+' a > .jstree-icon { '}else{icons_css+='.jstree-'+_this.get_index()+' li['+attr+'="'+i+'"] > a > .jstree-icon { '}if(a.icon.image){icons_css+=' background-image:url('+a.icon.image+'); '}if(a.icon.position){icons_css+=' background-position:'+a.icon.position+'; '}else{icons_css+=' background-position:0 0; '}icons_css+='} '}});if(icons_css!==""){$.vakata.css.add_sheet({'str':icons_css,title:"jstree-types"})}},this)).bind("before.jstree",$.proxy(function(e,a){var s,t,o=this._get_settings().types.use_data?this._get_node(a.args[0]):false,d=o&&o!==-1&&o.length?o.data("jstree"):false;if(d&&d.types&&d.types[a.func]===false){e.stopImmediatePropagation();return false}if($.inArray(a.func,this.data.types.attach_to)!==-1){if(!a.args[0]||(!a.args[0].tagName&&!a.args[0].jquery)){return}s=this._get_settings().types.types;t=this._get_type(a.args[0]);if(((s[t]&&typeof s[t][a.func]!=="undefined")||(s["default"]&&typeof s["default"][a.func]!=="undefined"))&&this._check(a.func,a.args[0])===false){e.stopImmediatePropagation();return false}}},this));if(A){this.get_container().bind("load_node.jstree set_type.jstree",$.proxy(function(e,b){var r=b&&b.rslt&&b.rslt.obj&&b.rslt.obj!==-1?this._get_node(b.rslt.obj).parent():this.get_container_ul(),c=false,s=this._get_settings().types;$.each(s.types,function(i,a){if(a.icon&&(a.icon.image||a.icon.position)){c=i==="default"?r.find("li > a > .jstree-icon"):r.find("li["+s.type_attr+"='"+i+"'] > a > .jstree-icon");if(a.icon.image){c.css("backgroundImage","url("+a.icon.image+")")}c.css("backgroundPosition",a.icon.position||"0 0")}})},this))}},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:false,type_attr:"rel",types:{"default":{"max_children":-1,"max_depth":-1,"valid_children":"all"}}},_fn:{_types_notify:function(n,a){if(a.type&&this._get_settings().types.use_data){this.set_type(a.type,n)}},_get_type:function(a){a=this._get_node(a);return(!a||!a.length)?false:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,b){b=this._get_node(b);var c=(!b.length||!a)?false:b.attr(this._get_settings().types.type_attr,a);if(c){this.__callback({obj:b,type:a})}return c},_check:function(a,b,c){b=this._get_node(b);var v=false,t=this._get_type(b),d=0,_this=this,s=this._get_settings().types,data=false;if(b===-1){if(!!s[a]){v=s[a]}else{return}}else{if(t===false){return}data=s.use_data?b.data("jstree"):false;if(data&&data.types&&typeof data.types[a]!=="undefined"){v=data.types[a]}else if(!!s.types[t]&&typeof s.types[t][a]!=="undefined"){v=s.types[t][a]}else if(!!s.types["default"]&&typeof s.types["default"][a]!=="undefined"){v=s.types["default"][a]}}if($.isFunction(v)){v=v.call(this,b)}if(a==="max_depth"&&b!==-1&&c!==false&&s.max_depth!==-2&&v!==0){b.children("a:eq(0)").parentsUntil(".jstree","li").each(function(i){if(s.max_depth!==-1&&s.max_depth-(i+1)<=0){v=0;return false}d=(i===0)?v:_this._check(a,this,false);if(d!==-1&&d-(i+1)<=0){v=0;return false}if(d>=0&&(d-(i+1)<v||v<0)){v=d-(i+1)}if(s.max_depth>=0&&(s.max_depth-(i+1)<v||v<0)){v=s.max_depth-(i+1)}})}return v},check_move:function(){if(!this.__call_old()){return false}var m=this._get_move(),s=m.rt._get_settings().types,mc=m.rt._check("max_children",m.cr),md=m.rt._check("max_depth",m.cr),vc=m.rt._check("valid_children",m.cr),ch=0,d=1,t;if(vc==="none"){return false}if($.isArray(vc)&&m.ot&&m.ot._get_type){m.o.each(function(){if($.inArray(m.ot._get_type(this),vc)===-1){d=false;return false}});if(d===false){return false}}if(s.max_children!==-2&&mc!==-1){ch=m.cr===-1?this.get_container().find("> ul > li").not(m.o).length:m.cr.find("> ul > li").not(m.o).length;if(ch+m.o.length>mc){return false}}if(s.max_depth!==-2&&md!==-1){d=0;if(md===0){return false}if(typeof m.o.d==="undefined"){t=m.o;while(t.length>0){t=t.find("> ul > li");d++}m.o.d=d}if(md-m.o.d<0){return false}}return true},create_node:function(a,b,c,d,e,f){if(!f&&(e||this._is_loaded(a))){var p=(typeof b=="string"&&b.match(/^before|after$/i)&&a!==-1)?this._get_parent(a):this._get_node(a),s=this._get_settings().types,mc=this._check("max_children",p),md=this._check("max_depth",p),vc=this._check("valid_children",p),ch;if(typeof c==="string"){c={data:c}}if(!c){c={}}if(vc==="none"){return false}if($.isArray(vc)){if(!c.attr||!c.attr[s.type_attr]){if(!c.attr){c.attr={}}c.attr[s.type_attr]=vc[0]}else{if($.inArray(c.attr[s.type_attr],vc)===-1){return false}}}if(s.max_children!==-2&&mc!==-1){ch=p===-1?this.get_container().find("> ul > li").length:p.find("> ul > li").length;if(ch+1>mc){return false}}if(s.max_depth!==-2&&md!==-1&&(md-1)<0){return false}}return this.__call_old(true,a,b,c,d,e,f)}}})})(jQuery);(function($){$.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.html_data.original_container_html.find("li").addBack().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:false,ajax:false,correct_state:true},_fn:{load_node:function(a,b,c){var d=this;this.load_node_html(a,function(){d.__callback({"obj":d._get_node(a)});b.call(this)},c)},_is_loaded:function(a){a=this._get_node(a);return a==-1||!a||(!this._get_settings().html_data.ajax&&!$.isFunction(this._get_settings().html_data.data))||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_html:function(b,c,f){var d,s=this.get_settings().html_data,error_func=function(){},success_func=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree_is_loading")){return}else{b.data("jstree_is_loading",true)}}switch(!0){case($.isFunction(s.data)):s.data.call(this,b,$.proxy(function(d){if(d&&d!==""&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")!==""){d=$(d);if(!d.is("ul")){d=$("<ul />").append(d)}if(b==-1||!b){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree_is_loading")}this.clean_node(b);if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}},this));break;case(!s.data&&!s.ajax):if(!b||b==-1){this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(c){c.call(this)}break;case(!!s.data&&!s.ajax)||(!!s.data&&!!s.ajax&&(!b||b===-1)):if(!b||b==-1){d=$(s.data);if(!d.is("ul")){d=$("<ul />").append(d)}this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(c){c.call(this)}break;case(!s.data&&!!s.ajax)||(!!s.data&&!!s.ajax&&b&&b!==-1):b=this._get_node(b);error_func=function(x,t,e){var a=this.get_settings().html_data.ajax.error;if(a){a.call(this,x,t,e)}if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(t==="success"&&s.correct_state){this.correct_state(b)}}else{if(t==="success"&&s.correct_state){this.get_container().children("ul").empty()}}if(f){f.call(this)}};success_func=function(d,t,x){var a=this.get_settings().html_data.ajax.success;if(a){d=a.call(this,d,t,x)||d}if(d===""||(d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")==="")){return error_func.call(this,x,t,"")}if(d){d=$(d);if(!d.is("ul")){d=$("<ul />").append(d)}if(b==-1||!b){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree_is_loading")}this.clean_node(b);if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree_is_loading");if(s.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(s.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}};s.ajax.context=this;s.ajax.error=error_func;s.ajax.success=success_func;if(!s.ajax.dataType){s.ajax.dataType="html"}if($.isFunction(s.ajax.url)){s.ajax.url=s.ajax.url.call(this,b)}if($.isFunction(s.ajax.data)){s.ajax.data=s.ajax.data.call(this,b)}$.ajax(s.ajax);break}}}});$.jstree.defaults.plugins.push("html_data")})(jQuery);(function($){$.jstree.plugin("themeroller",{__init:function(){var s=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(e){if(!$(e.currentTarget).hasClass("jstree-loading")){$(this).addClass(s.item_h)}}).delegate("a","mouseleave.jstree",function(){$(this).removeClass(s.item_h)}).bind("init.jstree",$.proxy(function(e,a){a.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(a.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",$.proxy(function(e,a){this._themeroller(a.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",$.proxy(function(e){this._themeroller()},this)).bind("close_node.jstree",$.proxy(function(e,a){this._themeroller(a.rslt.obj)},this)).bind("delete_node.jstree",$.proxy(function(e,a){this._themeroller(a.rslt.parent)},this)).bind("correct_state.jstree",$.proxy(function(e,a){a.rslt.obj.children("ins.jstree-icon").removeClass(s.opened+" "+s.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(s.item_open+" "+s.item_clsd).addClass(s.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",$.proxy(function(e,a){a.rslt.obj.children("a").addClass(s.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",$.proxy(function(e,a){this.get_container().find("a."+s.item_a).removeClass(s.item_a).end().find("a.jstree-clicked").addClass(s.item_a)},this)).bind("dehover_node.jstree",$.proxy(function(e,a){a.rslt.obj.children("a").removeClass(s.item_h)},this)).bind("hover_node.jstree",$.proxy(function(e,a){this.get_container().find("a."+s.item_h).not(a.rslt.obj).removeClass(s.item_h);a.rslt.obj.children("a").addClass(s.item_h)},this)).bind("move_node.jstree",$.proxy(function(e,a){this._themeroller(a.rslt.o);this._themeroller(a.rslt.op)},this))},__destroy:function(){var s=this._get_settings().themeroller,c=["ui-icon"];$.each(s,function(i,v){v=v.split(" ");if(v.length){c=c.concat(v)}});this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "))},_fn:{_themeroller:function(a){var s=this._get_settings().themeroller;a=(!a||a==-1)?this.get_container_ul():this._get_node(a);a=(!a||a==-1)?this.get_container_ul():a.parent();a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(s.opened).addClass("ui-icon "+s.closed).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(s.item_leaf+" "+s.item_open).addClass(s.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(s.closed).addClass("ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(s.item_leaf+" "+s.item_clsd).addClass(s.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(s.closed+" ui-icon "+s.opened).end().children("a").addClass(s.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(s.item_clsd,"").replace(s.item_open,"").replace(s.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(s.item_clsd+" "+s.item_open).addClass(s.item_leaf||"jstree-no-icon")}},defaults:{"opened":"ui-icon-triangle-1-se","closed":"ui-icon-triangle-1-e","item":"ui-state-default","item_h":"ui-state-hover","item_a":"ui-state-active","item_open":"ui-icon-folder-open","item_clsd":"ui-icon-folder-collapsed","item_leaf":"ui-icon-document"}});$(function(){var a=''+'.jstree-themeroller .ui-icon { overflow:visible; } '+'.jstree-themeroller a { padding:0 2px; } '+'.jstree-themeroller .jstree-no-icon { display:none; }';$.vakata.css.add_sheet({str:a,title:"jstree"})})})(jQuery);(function($){$.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",$.proxy(function(e,a){var b=[],res=true,p,t;if(a.func=="move_node"){if(a.args[4]===true){if(a.args[0].o&&a.args[0].o.length){a.args[0].o.children("a").each(function(){b.push($(this).text().replace(/^\s+/g,""))});res=this._check_unique(b,a.args[0].np.find("> ul > li").not(a.args[0].o),"move_node")}}}if(a.func=="create_node"){if(a.args[4]||this._is_loaded(a.args[0])){p=this._get_node(a.args[0]);if(a.args[1]&&(a.args[1]==="before"||a.args[1]==="after")){p=this._get_parent(a.args[0]);if(!p||p===-1){p=this.get_container()}}if(typeof a.args[2]==="string"){b.push(a.args[2])}else if(!a.args[2]||!a.args[2].data){b.push(this._get_string("new_node"))}else{b.push(a.args[2].data)}res=this._check_unique(b,p.find("> ul > li"),"create_node")}}if(a.func=="rename_node"){b.push(a.args[1]);t=this._get_node(a.args[0]);p=this._get_parent(t);if(!p||p===-1){p=this.get_container()}res=this._check_unique(b,p.find("> ul > li").not(t),"rename_node")}if(!res){e.stopPropagation();return false}},this))},defaults:{error_callback:$.noop},_fn:{_check_unique:function(a,p,b){var c=[],ok=true;p.children("a").each(function(){c.push($(this).text().replace(/^\s+/g,""))});if(!c.length||!a.length){return true}$.each(a,function(i,v){if($.inArray(v,c)!==-1){ok=false;return false}});if(!ok){this._get_settings().unique.error_callback.call(null,a,p,b)}return ok},check_move:function(){if(!this.__call_old()){return false}var p=this._get_move(),nms=[];if(p.o&&p.o.length){p.o.children("a").each(function(){nms.push($(this).text().replace(/^\s+/g,""))});return this._check_unique(nms,p.np.find("> ul > li").not(p.o),"check_move")}return true}}})})(jQuery);(function($){$.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui){throw"jsTree wholerow: jsTree UI plugin not included.";}this.data.wholerow.html=false;this.data.wholerow.to=false;this.get_container().bind("init.jstree",$.proxy(function(e,a){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",$.proxy(function(e,a){this._prepare_wholerow_span(a&&a.rslt&&a.rslt.obj?a.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",$.proxy(function(e,a){if(this.data.to){clearTimeout(this.data.to)}this.data.to=setTimeout((function(t,o){return function(){t._prepare_wholerow_ul(o)}})(this,a&&a.rslt&&a.rslt.obj?a.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",$.proxy(function(e,a){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",$.proxy(function(e,b){b.rslt.obj.each(function(){var a=b.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt((($(this).offset().top-b.inst.get_container().offset().top+b.inst.get_container()[0].scrollTop)/b.inst.data.core.li_height),10))+")");a.children("a").attr("class",b.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",$.proxy(function(e,a){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(e.type==="hover_node"){var b=this.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt(((a.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height),10))+")");b.children("a").attr("class",a.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(e){var n=$(e.currentTarget);if(e.target.tagName==="A"||(e.target.tagName==="INS"&&n.closest("li").is(".jstree-open, .jstree-closed"))){return}n.closest("li").children("a:visible:eq(0)").click();e.stopImmediatePropagation()}).delegate("li","mouseover.jstree",$.proxy(function(e){e.stopImmediatePropagation();if($(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length){return false}this.hover_node(e.currentTarget);return false},this)).delegate("li","mouseleave.jstree",$.proxy(function(e){if($(e.currentTarget).children("a").hasClass("jstree-hovered").length){return}this.dehover_node(e.currentTarget)},this));if(is_ie7||A){$.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})}},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(b){b=!b||b==-1?this.get_container().find("> ul > li"):this._get_node(b);if(b===false){return}b.each(function(){$(this).find("li").addBack().each(function(){var a=$(this);if(a.children(".jstree-wholerow-span").length){return true}a.prepend("<span class='jstree-wholerow-span' style='width:"+(a.parentsUntil(".jstree","li").length*18)+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var o=this.get_container().children("ul").eq(0),h=o.html();o.addClass("jstree-wholerow-real");if(this.data.wholerow.last_html!==h){this.data.wholerow.last_html=h;this.get_container().children(".jstree-wholerow").remove();this.get_container().append(o.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(o.parent()[0].scrollWidth).css("top",(o.height()+(is_ie7?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end())}}}});$(function(){var a=''+'.jstree .jstree-wholerow-real { position:relative; z-index:1; } '+'.jstree .jstree-wholerow-real li { cursor:pointer; } '+'.jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } '+'.jstree .jstree-wholerow { position:relative; z-index:0; height:0; } '+'.jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } '+'.jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } '+'.jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }'+'.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }'+'.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } '+'.jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }';if(is_ff2){a+=''+'.jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } '+'.jstree .jstree-wholerow-real a { border-color:transparent !important; } '}if(is_ie7||A){a+=''+'.jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } '+'.jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } '}$.vakata.css.add_sheet({str:a,title:"jstree"})})})(jQuery);(function($){var e=["getChildren","getChildrenCount","getAttr","getName","getProps"],validateInterface=function(a,b){var c=true;a=a||{};b=[].concat(b);$.each(b,function(i,v){if(!$.isFunction(a[v])){c=false;return false}});return c};$.jstree.plugin("model",{__init:function(){if(!this.data.json_data){throw"jsTree model: jsTree json_data plugin not included.";}this._get_settings().json_data.data=function(n,b){var c=(n==-1)?this._get_settings().model.object:n.data("jstree_model");if(!validateInterface(c,e)){return b.call(null,false)}if(this._get_settings().model.async){c.getChildren($.proxy(function(a){this.model_done(a,b)},this))}else{this.model_done(c.getChildren(),b)}}},defaults:{object:false,id_prefix:false,async:false},_fn:{model_done:function(b,c){var d=[],s=this._get_settings(),_this=this;if(!$.isArray(b)){b=[b]}$.each(b,function(i,a){var r=a.getProps()||{};r.attr=a.getAttr()||{};if(a.getChildrenCount()){r.state="closed"}r.data=a.getName();if(!$.isArray(r.data)){r.data=[r.data]}if(_this.data.types&&$.isFunction(a.getType)){r.attr[s.types.type_attr]=a.getType()}if(r.attr.id&&s.model.id_prefix){r.attr.id=s.model.id_prefix+r.attr.id}if(!r.metadata){r.metadata={}}r.metadata.jstree_model=a;d.push(r)});c.call(null,d)}}})})(jQuery)})();